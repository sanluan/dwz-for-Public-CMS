var JUI={version:"1.6.2",regPlugins:[],keyCode:{ENTER:13,ESC:27,END:35,HOME:36,SHIFT:16,TAB:9,LEFT:37,RIGHT:39,UP:38,DOWN:40,DELETE:46,BACKSPACE:8,CHAR_S:83},eventType:{pageClear:"pageClear",editorSync:"editorSync",resizeGrid:"resizeGrid",resizeChart:"resizeChart",initEnvAfter:"initEnvAfter"},isOverAxis:function(x,reference,size){return reference<x&&x<reference+size},isOver:function(y,x,top,left,height,width){return this.isOverAxis(y,top,height)&&this.isOverAxis(x,left,width)},pageInfo:{pageNum:"pageNum",numPerPage:"numPerPage",orderField:"orderField",orderDirection:"orderDirection"},statusCode:{ok:200,okAndRefresh:201,error:300,timeout:301},keys:{statusCode:"statusCode",message:"message"},ui:{sbar:!0},frag:{},_msg:{},_set:{loginUrl:"",loginTitle:"",debug:!1},msg:function(key,args){return function(str,args){args=args||[];for(var result=str||"",i=0;i<args.length;i++)result=result.replace(new RegExp("\\{"+i+"\\}","g"),args[i]);return result}(this._msg[key],args)},debug:function(msg){this._set.debug&&("undefined"!=typeof console?console.log(msg):alert(msg))},loadLogin:function(){$.pdialog&&JUI._set.loginTitle?$.pdialog.open(JUI._set.loginUrl,"login",JUI._set.loginTitle,{mask:!0,width:520,height:260}):window.location=JUI._set.loginUrl},instances:{},obj2str:function(o){var r=[];if("string"==typeof o)return'"'+o.replace(/([\'\"\\])/g,"\\$1").replace(/(\n)/g,"\\n").replace(/(\r)/g,"\\r").replace(/(\t)/g,"\\t")+'"';if("object"!=typeof o)return o.toString();if(o.sort){for(i=0;i<o.length;i++)r.push(JUI.obj2str(o[i]));r="["+r.join()+"]"}else{for(var i in o)r.push('"'+i+'":'+JUI.obj2str(o[i]));document.all&&!/^\n?function\s*toString\(\)\s*\{\n?\s*\[native code\]\n?\s*\}\n?\s*$/.test(o.toString)&&r.push("toString:"+o.toString.toString()),r="{"+r.join()+"}"}return r},jsonEval:function(data){try{return"string"==typeof data?eval("("+data+")"):data}catch(e){return{}}},ajaxError:function(xhr,ajaxOptions,thrownError){var exception;alertMsg?(void 0!==thrownError&&""!=thrownError||(exception=$($.parseHTML(xhr.responseText,document,!0)).find("#divexception textarea")).length&&(thrownError=exception.val()),alertMsg.error("<div>Http status: "+xhr.status+" "+xhr.statusText+"</div><div>ajaxOptions: "+ajaxOptions+"</div><div>thrownError: "+thrownError+"</div>")):alert("Http status: "+xhr.status+" "+xhr.statusText+"\najaxOptions: "+ajaxOptions+"\nthrownError:"+thrownError+"\n"+xhr.responseText)},ajaxDone:function(json){json[JUI.keys.statusCode]==JUI.statusCode.error?json[JUI.keys.message]&&alertMsg&&alertMsg.error(json[JUI.keys.message]):json[JUI.keys.statusCode]==JUI.statusCode.timeout?alertMsg?alertMsg.error(json[JUI.keys.message]||JUI.msg("sessionTimout"),{okCall:JUI.loadLogin}):JUI.loadLogin():json[JUI.keys.statusCode]==JUI.statusCode.okAndRefresh?json[JUI.keys.message]&&alertMsg&&alertMsg.correct(json[JUI.keys.message],{callback:function(){window.location.reload()}}):json[JUI.keys.message]&&alertMsg&&alertMsg.correct(json[JUI.keys.message])},init:function(_doc,options){var op=$.extend({loginUrl:"login.html",loginTitle:null,callback:null,debug:!1,statusCode:{}},options);this._set.loginUrl=op.loginUrl,this._set.loginTitle=op.loginTitle,this._set.debug=op.debug,$.extend(JUI.statusCode,op.statusCode),$.extend(JUI.keys,op.keys),$.extend(JUI.pageInfo,op.pageInfo),$.ajax({type:"GET",url:_doc,dataType:"html",cache:!1,error:function(xhr){alert(xhr.statusText)},success:function(html){$($.parseHTML(html,document,!0)).each(function(){var fragId=$(this).attr("id");fragId&&(JUI.frag[fragId]=$(this).text())}),"function"==typeof op.callback&&op.callback()}}),$(window).isBind(JUI.eventType.resizeChart)||$(window).on(JUI.eventType.resizeChart,null,null,function(){$(".chart").each(function(){$chart=$(this),$chart.data("id")&&window[$chart.data("id")]&&"function"==typeof window[$chart.data("id")].resize&&window[$chart.data("id")].resize()})});_doc=$(document);_doc.isBind(JUI.eventType.editorSync)||_doc.on(JUI.eventType.editorSync,null,null,function($box){$box=$box.target,$box=$($box);$("textarea.editor",$box).each(function(){"ckeditor"==$(this).attr("editorType")?CKEDITOR.instances[$(this).data("id")]&&CKEDITOR.instances[$(this).data("id")].updateElement():"tinymce"==$(this).attr("editorType")?tinymce.get($(this).data("id"))&&tinymce.get($(this).data("id")).save():"kindeditor"==$(this).attr("editorType")?KindEditor.sync("#"+$(this).data("id")):UE.instants[$(this).data("id")]&&UE.instants[$(this).data("id")].sync()}),$("textarea.code",$box).each(function(){JUI.instances[$(this).data("id")]&&JUI.instances[$(this).data("id")].save()}),$(".miscSortDrag",$box).each(function(){var $sortBox=$(this);$sortBox.data("result")&&$sortBox.find($sortBox.data("result")).val(JUI.obj2str($sortBox.miscSortDragData($sortBox)))})}),_doc.isBind(JUI.eventType.pageClear)||_doc.on(JUI.eventType.pageClear,null,null,function($box){$box=$box.target,$box=$($box);$("textarea.editor",$box).each(function(){"ckeditor"==$(this).attr("editorType")?CKEDITOR.instances[$(this).data("id")]&&CKEDITOR.instances[$(this).data("id")].destroy():"tinymce"==$(this).attr("editorType")?tinymce.remove("#"+$(this).data("id")):"kindeditor"==$(this).attr("editorType")?KindEditor.remove("#"+$(this).data("id")):UE.instants[$(this).data("id")]&&UE.instants[$(this).data("id")].destroy()}),$("textarea.code",$box).each(function(){JUI.instances[$(this).data("id")]&&(JUI.instances[$(this).data("id")].toTextArea(),delete JUI.instances[$(this).data("id")])}),$(".image-editor",$box).each(function(){JUI.instances[$(this).data("id")]&&(JUI.instances[$(this).data("id")].destroy(),delete JUI.instances[$(this).data("id")])}),$("[close-url]",$box).each(function(){$.getJSON($(this).attr("close-url"),function(data){})})})}};function html2Escape(sHtml){return Base64.encode(sHtml)}function escapeJquery(srcString){for(var escapseResult=srcString,jsSpecialChars=["\\","^","$","*","?",".","+","(",")","[","]","|","{","}"],jquerySpecialChars=["~","`","@","#","%","&","=","'",'"'," ",":",";","<",">",",","/"],i=0;i<jsSpecialChars.length;i++)escapseResult=escapseResult.replace(new RegExp("\\"+jsSpecialChars[i],"g"),"\\"+jsSpecialChars[i]);for(i=0;i<jquerySpecialChars.length;i++)escapseResult=escapseResult.replace(new RegExp(jquerySpecialChars[i],"g"),"\\"+jquerySpecialChars[i]);return escapseResult}function escapeHtml(str){return str&&str.encodeTXT()}function Map(){this.elements=new Array,this.size=function(){return this.elements.length},this.isEmpty=function(){return this.elements.length<1},this.clear=function(){this.elements=new Array},this.put=function(_key,_value){this.remove(_key),this.elements.push({key:_key,value:_value})},this.remove=function(_key){try{for(i=0;i<this.elements.length;i++)if(this.elements[i].key==_key)return this.elements.splice(i,1),!0}catch(e){return!1}return!1},this.get=function(_key){try{for(i=0;i<this.elements.length;i++)if(this.elements[i].key==_key)return this.elements[i].value}catch(e){return null}},this.element=function(_index){return _index<0||_index>=this.elements.length?null:this.elements[_index]},this.containsKey=function(_key){try{for(i=0;i<this.elements.length;i++)if(this.elements[i].key==_key)return!0}catch(e){return!1}return!1},this.values=function(){var arr=new Array;for(i=0;i<this.elements.length;i++)arr.push(this.elements[i].value);return arr},this.keys=function(){var arr=new Array;for(i=0;i<this.elements.length;i++)arr.push(this.elements[i].key);return arr}}function initEnv(){if($("body").append(JUI.frag.dwzFrag),!$.support.leadingWhitespace)try{document.execCommand("BackgroundImageCache",!1,!0)}catch(e){}$(window).resize(function(){initLayout(),$(this).trigger(JUI.eventType.resizeGrid),$(this).trigger(JUI.eventType.resizeChart)});var ajaxbg=$("#background,#progressBar");ajaxbg.hide(),$(document).ajaxStart(function(){ajaxbg.show()}).ajaxStop(function(){ajaxbg.hide()}),$("#progressBar").click(function(){ajaxbg.hide()}),$("#leftside").jBar({minW:150,maxW:700}),$.taskBar&&$.taskBar.init(),setTimeout(function(){var hash,callback,parentId,tabid;initLayout(),window.navTab&&navTab.init(),initUI(),$.fn.navMenu&&((hash=location.hash.skipChar("#").replace(/\?.*$/,""))&&(parentId=hash.substring(0,hash.indexOf("_")),(tabid=hash.substring(hash.indexOf("_")+1))&&(callback=function(){var $box=$("#menu a[rel="+escapeJquery(tabid)+"]").closest(".accordionContent");$box.is(":visible")||$box.prev().click(),$("#menu a[rel="+escapeJquery(tabid)+"]").click()})),$("#navMenu").navMenu(callback),parentId&&$("#navMenu a[parentid="+parentId+"]").click()),$(document).trigger(JUI.eventType.initEnvAfter)},10)}function initLayout(){var iContentW=$(window).width()-(JUI.ui.sbar?$("#sidebar").width():0),iContentH=$(window).height()-$("header").outerHeight(!0)-$("footer").outerHeight(!0);$("#navTab").css({width:iContentW+"px"}),$("main .tabsPageContent").height(iContentH-$(".tabsPageHeader").outerHeight(!0)).find("[layoutH]").layoutH(),$("#splitBar, #splitBarProxy").height(iContentH-2),$("#taskbar").css({top:iContentH+$("header").height()+"px",width:$(window).width()+"px"}),$("#menu").css({"max-height":iContentH-$("#sidebar .collapse").height()+"px"})}function initUI(_box){var $p=$(_box||document);$("table.list",$p).cssTable(),$("table.table",$p).jTable(),$("div.tabs",$p).each(function(){var $this=$(this),options={};options.currentIndex=$this.attr("currentIndex")||0,options.eventType=$this.attr("eventType")||"click",$this.tabs(options)}),$("ul.tree",$p).jTree(),$("div.accordion",$p).each(function(){$(this).accordion({alwaysOpen:!1,active:0,autoheight:!1})}),$(":button.checkboxCtrl, :checkbox.checkboxCtrl",$p).checkboxCtrl($p),$.fn.combox&&$("select.combox",$p).combox(),$.fn.uploadify&&$(":file[uploaderOption]",$p).each(function(){var $this=$(this),options={fileObjName:$this.attr("name")||"file",auto:!0,multi:!0,onUploadError:uploadifyError},uploaderOption=JUI.jsonEval($this.attr("uploaderOption"));$.extend(options,uploaderOption),JUI.debug("uploaderOption: "+JUI.obj2str(uploaderOption)),$this.uploadify(options)}),$("form.required-validate",$p).each(function(){var $form=$(this);$form.validate({onsubmit:!1,focusInvalid:!1,focusCleanup:!0,errorElement:"span",ignore:".ignore",invalidHandler:function(form,message){message=message.numberOfInvalids();message&&(message=JUI.msg("validateFormError",[message]),alertMsg.error(message))}}),$form.find("input[customvalid]").each(function(){var $input=$(this);$input.rules("add",{customvalid:$input.attr("customvalid")})})}),$.fn.datepicker&&$("input.date",$p).each(function(){var $this=$(this),opts={};$this.attr("dateFmt")&&(opts.pattern=$this.attr("dateFmt")),$this.attr("minDate")&&(opts.minDate=$this.attr("minDate")),$this.attr("maxDate")&&(opts.maxDate=$this.attr("maxDate")),$this.attr("mmStep")&&(opts.mmStep=$this.attr("mmStep")),$this.attr("ssStep")&&(opts.ssStep=$this.attr("ssStep")),$this.datepicker(opts)}),initLink($p),$.fn.sortDrag&&$("div.sortDrag",$p).sortDrag(),$.fn.miscSortDrag&&$(".miscSortDrag",$p).miscSortDrag(),$.fn.multLookup&&$("[multLookup]:button",$p).multLookup(),$.fn.suggest&&$("input[suggestFields]",$p).suggest(),$.fn.itemDetail&&$("table.itemDetail",$p).itemDetail(),$.each(JUI.regPlugins,function(index,fn){fn($p)}),$("input[type=text], input[type=number], input[type=password], textarea",$p).not("textarea.editor",$p).addClass("textInput"),$("input[readonly], textarea[readonly]",$p).addClass("readonly"),$("input[disabled=true], textarea[disabled=true]",$p).addClass("disabled"),$("input[type=text]",$p).not("div.tabs input[type=text]",$p).filter("[alt]").inputAlert()}function initLink($p){$("a[target=navTab]",$p).each(function(){$(this).click(function(event){var $this=$(this),title=$this.attr("title")||$this.text(),title=title&&title.replace(/<[^>]*>/gi,""),icon=$this.attr("icon")||$this.find("i").prop("outerHTML"),tabid=$this.attr("rel")||"_blank",fresh=eval($this.attr("fresh")||"true"),external=eval($this.attr("external")||"false"),url=$this.attr("href").replaceTmById($(event.target).parents(".unitBox:first")),newWindow=navigator.platform.match("Mac")?event.metaKey:event.ctrlKey;return(JUI.debug(url),url.isFinishedTm())?(navTab.openTab(tabid,url,{title:title,icon:icon,fresh:fresh,external:external,focusNewWindow:newWindow}),!1):(alertMsg.error($this.attr("warn")||JUI.msg("alertSelectMsg")),!1)})}),$("a[target=dialog]",$p).each(function(){$(this).click(function(event){var $this=$(this),title=$this.attr("title")||$this.text(),rel=$this.attr("rel")||"_blank",options={},w=$this.attr("width"),h=$this.attr("height");w&&(options.width=w),h&&(options.height=h),options.max=eval($this.attr("max")||"false"),options.mask=eval($this.attr("mask")||"false"),options.maxable=eval($this.attr("maxable")||"true"),options.minable=eval($this.attr("minable")||"true"),options.fresh=eval($this.attr("fresh")||"true"),options.resizable=eval($this.attr("resizable")||"true"),options.drawable=eval($this.attr("drawable")||"true"),options.close=eval($this.attr("close")||""),options.param=$this.attr("param")||"",options.focusNewWindow=navigator.platform.match("Mac")?event.metaKey:event.ctrlKey;var url=$this.attr("href").replaceTmById($(event.target).parents(".unitBox:first"));return(JUI.debug(url),url.isFinishedTm())?($.pdialog.open(url,rel,title,options),!1):(alertMsg.error($this.attr("warn")||JUI.msg("alertSelectMsg")),!1)})}),$("a[target=ajax]",$p).each(function(){$(this).click(function(){var $rel,$this=$(this),rel=$this.attr("rel");return rel&&($rel=$("#"+rel)).loadUrl($this.attr("href"),{},function(){$rel.find("[layoutH]").layoutH()}),!1})}),$.fn.ajaxTodo&&$("a[target=ajaxTodo]",$p).ajaxTodo(),$.fn.dwzExport&&$("a[target=dwzExport]",$p).dwzExport(),$.fn.lookup&&$("a[lookupGroup]",$p).lookup(),$.fn.selectedTodo&&$("a[target=selectedTodo]",$p).selectedTodo()}!function($){$.setRegional=function(key,value){$.regional||($.regional={}),$.regional[key]=value},$.setMessage=function(key,value){JUI._msg[key]=value},$.fn.extend({ajaxUrl:function(op){var $this=$(this);$this.trigger(JUI.eventType.pageClear),$.ajax({type:op.type||"GET",url:op.url,data:op.data,cache:!1,success:function(response){var json=JUI.jsonEval(response);json[JUI.keys.statusCode]==JUI.statusCode.error?json[JUI.keys.message]&&alertMsg.error(json[JUI.keys.message]):json[JUI.keys.statusCode]==JUI.statusCode.timeout?($this.html(response),$.pdialog&&$.pdialog.checkTimeout(),navTab&&navTab.checkTimeout(),alertMsg.error(json[JUI.keys.message]||JUI.msg("sessionTimout"),{okCall:function(){JUI.loadLogin()}})):($this.html(response).initUI(),"function"==typeof op.callback&&op.callback(response))},error:JUI.ajaxError,statusCode:{503:function(xhr,ajaxOptions,thrownError){alert(JUI.msg("statusCode_503")||thrownError)}}})},loadUrl:function(url,data,callback){$(this).ajaxUrl({url:url,data:data,callback:callback})},initUI:function(){return this.each(function(){"function"==typeof initUI&&initUI(this)})},layoutH:function($refBox){return this.each(function(){var $this=$(this),iH=($refBox=$refBox||$this.parents("div.layoutBox:first")).height(),iLayoutH=0;0!=$this.parents(".rightPageContent").length?iLayoutH=$this.getSiblingsElemsH($this.parents(".rightPageContent")):0!=$this.parents(".leftPageContent").length?iLayoutH=$this.getSiblingsElemsH($this.parents(".leftPageContent")):0!=$this.parents(".pageFormContent").length?iLayoutH=$this.getSiblingsElemsH($this.parents(".pageFormContent"))+30:0!=$this.parents(".page").length?iLayoutH=$this.getSiblingsElemsH($this.parents(".page")):0!=$this.parents(".dialogContent").length&&(iLayoutH=$this.getSiblingsElemsH($this.parents(".dialogContent")));iH=50<iH-iLayoutH?iH-iLayoutH:50;$this.isTag("table")?$this.removeAttr("layoutH").wrap('<div layoutH="'+iLayoutH+'" style="overflow:auto;height:'+iH+'px"></div>'):$this.outerHeight(iH).css("overflow","auto")})},getSiblingsElemsH:function(tabsHeaderH){var $page=tabsHeaderH,headerH=this.getElemsH($page,".pageHeader"),formBarH=this.getElemsH($page,".formBar"),contentTitleH=this.getElemsH($page,".contentTitle"),gridHeaderH=this.getElemsH($page,".gridHeader"),tabsHeaderH=this.getElemsH($page,".tabsHeader");return headerH+this.getElemsH($page,".pageBar.panelBar")+gridHeaderH+this.getElemsH($page,".panelBar:not(.pageBar)")+formBarH+tabsHeaderH+contentTitleH},getElemsH:function($elem,elem){var h=0,$elem=$elem.find(elem),isSilbinsElem=!0;if(0!=$elem.length&&0==this.find(elem).length){for(var $silbingsElems=this.siblings(),i=0;i<$silbingsElems.length;i++)if(0!=$silbingsElems.eq(i).find(elem).length){isSilbinsElem=!1;break}isSilbinsElem&&(h=$elem.outerHeight(!0))}return h},inputAlert:function(){return this.each(function(){var $label,$this=$(this);function getAltBox(){return $this.parent().find("label.alt")}function altBoxCss(opacity){var position=$this.position();return{width:$this.width(),top:position.top+"px",left:position.left+"px",opacity:opacity||1}}getAltBox().length<1&&($this.attr("id")||$this.attr("id",$this.attr("name")+"_"+Math.round(1e4*Math.random())),($label=$('<label class="alt" for="'+$this.attr("id")+'">'+$this.attr("alt")+"</label>").appendTo($this.parent())).css(altBoxCss(.6)),$this.val()&&$label.hide()),$this.focus(function(){getAltBox().css(altBoxCss(.3))}).blur(function(){$(this).val()||getAltBox().show().css("opacity",1)}).keydown(function(){getAltBox().hide()})})},isTag:function(tn){return!(!tn||null==$(this)[0])&&$(this)[0].tagName.toLowerCase()==tn},isBind:function(type){var _events=$(this).data("events");return _events&&type&&_events[type]}}),$.extend(String.prototype,{isPositiveInteger:function(){return new RegExp(/^[1-9]\d*$/).test(this)},isInteger:function(){return new RegExp(/^\d+$/).test(this)},isNumber:function(value,element){return new RegExp(/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/).test(this)},trim:function(){return this.replace(/(^\s*)|(\s*$)|\r|\n/g,"")},startsWith:function(pattern){return 0===this.indexOf(pattern)},endsWith:function(pattern){var d=this.length-pattern.length;return 0<=d&&this.lastIndexOf(pattern)===d},replaceSuffix:function(index){var i=this.lastIndexOf("[");return this.substring(0,i)+this.substring(i).replace(/\[[0-9]+\]/,"["+index+"]").replace("#index#",index)},encodeTXT:function(){return this.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll(" ","&nbsp;")},replaceAll:function(os,ns){return this.replace(new RegExp(os,"gm"),ns)},replaceTm:function(data){return data?this.replace(RegExp("({[A-Za-z_]+[A-Za-z0-9_]*})","g"),function($1){return data[$1.replace(/[{}]+/g,"")]}):this},replaceTmById:function(_box){var $parent=_box||$(document);return this.replace(RegExp("({[A-Za-z_]+[A-Za-z0-9_]*})","g"),function($1){var $input=$parent.find("#"+$1.replace(/[{}]+/g,""));return $input.val()?$input.val():$1})},isFinishedTm:function(){return!new RegExp("{[A-Za-z_]+[A-Za-z0-9_]*}").test(this)},skipChar:function(ch){return this&&0!==this.length?this.charAt(0)===ch?this.substring(1).skipChar(ch):this:""},isValidPwd:function(){return new RegExp(/^([_]|[a-zA-Z0-9]){6,32}$/).test(this)},isValidMail:function(){return new RegExp(/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/).test(this.trim())},isUrl:function(){return new RegExp(/^([a-zA-z]+:)?\/\/([a-zA-Z0-9\-\.]+)([-\w .\/?%&=:]*)$/).test(this)},isExternalUrl:function(){var domain=document.domain;return""==domain&&(domain="localhost"),this.isUrl()&&-1==this.indexOf("//"+domain)}})}(jQuery),function(){var MONTH_NAMES=new Array("January","February","March","April","May","June","July","August","September","October","November","December","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),DAY_NAMES=new Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sun","Mon","Tue","Wed","Thu","Fri","Sat");function LZ(x){return(x<0||9<x?"":"0")+x}function formatDate(s,format){format+="";var c,result="",i_format=0,token="",y=s.getYear()+"",M=s.getMonth()+1,d=s.getDate(),E=s.getDay(),H=s.getHours(),m=s.getMinutes(),s=s.getSeconds(),value={};for(y.length<4&&(y=""+(+y+1900)),value.y=""+y,value.yyyy=y,value.yy=y.substring(2,4),value.M=M,value.MM=LZ(M),value.MMM=MONTH_NAMES[M-1],value.NNN=MONTH_NAMES[M+11],value.d=d,value.dd=LZ(d),value.E=DAY_NAMES[E+7],value.EE=DAY_NAMES[E],value.H=H,value.HH=LZ(H),value.h=0==H?12:12<H?H-12:H,value.hh=LZ(value.h),value.K=11<H?H-12:H,value.k=H+1,value.KK=LZ(value.K),value.kk=LZ(value.k),value.a=11<H?"PM":"AM",value.m=m,value.mm=LZ(m),value.s=s,value.ss=LZ(s);i_format<format.length;){for(c=format.charAt(i_format),token="";format.charAt(i_format)==c&&i_format<format.length;)token+=format.charAt(i_format++);null!=value[token]?result+=value[token]:result+=token}return result}function _isInteger(val){return new RegExp(/^\d+$/).test(val)}function _getInt(str,i,minlength,maxlength){for(var x=maxlength;minlength<=x;x--){var token=str.substring(i,i+x);if(token.length<minlength)return null;if(_isInteger(token))return token}return null}function parseDate(val,format){val+="",format+="";for(var c,x,y,i_val=0,i_format=0,token="",now=new Date(1970,0,1),year=now.getYear(),month=now.getMonth()+1,date=1,hh=now.getHours(),mm=now.getMinutes(),ss=now.getSeconds(),ampm="";i_format<format.length;){for(c=format.charAt(i_format),token="";format.charAt(i_format)==c&&i_format<format.length;)token+=format.charAt(i_format++);if("yyyy"==token||"yy"==token||"y"==token){if("yyyy"==token&&(y=x=4),"yy"==token&&(y=x=2),"y"==token&&(x=2,y=4),null==(year=_getInt(val,i_val,x,y)))return 0;i_val+=year.length,2==year.length&&(year=70<year?+year+1900:+year+2e3)}else if("MMM"==token||"NNN"==token){for(var month=0,i=0;i<MONTH_NAMES.length;i++){var month_name=MONTH_NAMES[i];if(val.substring(i_val,i_val+month_name.length).toLowerCase()==month_name.toLowerCase()&&("MMM"==token||"NNN"==token&&11<i)){12<(month=i+1)&&(month-=12),i_val+=month_name.length;break}}if(month<1||12<month)return 0}else if("EE"==token||"E"==token)for(i=0;i<DAY_NAMES.length;i++){var day_name=DAY_NAMES[i];if(val.substring(i_val,i_val+day_name.length).toLowerCase()==day_name.toLowerCase()){i_val+=day_name.length;break}}else if("MM"==token||"M"==token){if(null==(month=_getInt(val,i_val,token.length,2))||month<1||12<month)return 0;i_val+=month.length}else if("dd"==token||"d"==token){if(null==(date=_getInt(val,i_val,token.length,2))||date<1||31<date)return 0;i_val+=date.length}else if("hh"==token||"h"==token){if(null==(hh=_getInt(val,i_val,token.length,2))||hh<1||12<hh)return 0;i_val+=hh.length}else if("HH"==token||"H"==token){if(null==(hh=_getInt(val,i_val,token.length,2))||hh<0||23<hh)return 0;i_val+=hh.length}else if("KK"==token||"K"==token){if(null==(hh=_getInt(val,i_val,token.length,2))||hh<0||11<hh)return 0;i_val+=hh.length}else if("kk"==token||"k"==token){if(null==(hh=_getInt(val,i_val,token.length,2))||hh<1||24<hh)return 0;i_val+=hh.length,hh--}else if("mm"==token||"m"==token){if(null==(mm=_getInt(val,i_val,token.length,2))||mm<0||59<mm)return 0;i_val+=mm.length}else if("ss"==token||"s"==token){if(null==(ss=_getInt(val,i_val,token.length,2))||ss<0||59<ss)return 0;i_val+=ss.length}else if("a"==token){if("am"==val.substring(i_val,i_val+2).toLowerCase())ampm="AM";else{if("pm"!=val.substring(i_val,i_val+2).toLowerCase())return 0;ampm="PM"}i_val+=2}else{if(val.substring(i_val,i_val+token.length)!=token)return 0;i_val+=token.length}}if(i_val!=val.length)return 0;if(2==month)if(year%4==0&&year%100!=0||year%400==0){if(29<date)return 0}else if(28<date)return 0;return(4==month||6==month||9==month||11==month)&&30<date?0:(hh<12&&"PM"==ampm?hh=+hh+12:11<hh&&"AM"==ampm&&(hh-=12),new Date(year,month-1,date,hh,mm,ss))}function replaceTmEval(data){return data.replace(RegExp("({[A-Za-z0-9_+-]*})","g"),function($1){return eval("("+$1.replace(/[{}]+/g,"")+")")})}Date.prototype.formatDate=function(dateFmt){return formatDate(this,dateFmt)},String.prototype.parseDate=function(dateFmt){return parseDate(this,dateFmt=this.length<dateFmt.length?dateFmt.slice(0,this.length):dateFmt)},Date.prototype.formatDateTm=function(dateFmt){var y=this.getFullYear(),m=this.getMonth()+1,aDate=this.getDate(),_y=1970,_m=0,_d=1,aDate=replaceTmEval(dateFmt.replaceAll("%y",y).replaceAll("%M",m).replaceAll("%d",aDate)).split("-");return 0<aDate.length&&(_y=aDate[0]),1<aDate.length&&(_m=aDate[1]-1),2<aDate.length&&(_d=aDate[2]),new Date(_y,_m,_d).formatDate("yyyy-MM-dd")}}(),function($){$.setRegional("datepicker",{dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),$.fn.datepicker=function(opts){var setting={box$:"#calendar",year$:"#calendar [name=year]",month$:"#calendar [name=month]",tmInputs$:"#calendar .time :text",hour$:"#calendar .time .hh",minute$:"#calendar .time .mm",second$:"#calendar .time .ss",tmBox$:"#calendar .tm",tmUp$:"#calendar .time .up",tmDown$:"#calendar .time .down",close$:"#calendar .close",calIcon$:"a.inputDateButton",main$:"#calendar .main",days$:"#calendar .days",dayNames$:"#calendar .dayNames",clearBut$:"#calendar .clearBut",okBut$:"#calendar .okBut"};function changeTmMenu(sltClass){var $tm=$(setting.tmBox$);$tm.removeClass("hh").removeClass("mm").removeClass("ss"),sltClass&&($tm.addClass(sltClass),$(setting.tmInputs$).removeClass("slt").filter("."+sltClass).addClass("slt"))}function clickTmMenu($input,type){$(setting.tmBox$).find("."+type+" li").each(function(){var $li=$(this);$li.click(function(){$input.val($li.text())})})}function keydownInt(e){if(!(48<=e.keyCode&&e.keyCode<=57||e.keyCode==JUI.keyCode.DELETE||e.keyCode==JUI.keyCode.BACKSPACE))return!1}function changeTm($input,type){var ivalue=parseInt($input.val()),istart=parseInt($input.attr("start"))||0,iend=parseInt($input.attr("end")),istep=parseInt($input.attr("step")||1);1==type?ivalue<=iend-istep&&$input.val(ivalue+istep):-1==type?istart+istep<=ivalue&&$input.val(ivalue-istep):iend<ivalue?$input.val(iend):ivalue<istart&&$input.val(istart)}return this.each(function(){var $this=$(this);new Datepicker($this.val(),opts);function generateCalendar(dp){var dw=dp.getDateWrap(),minDate=dp.getMinDate(),maxDate=dp.getMaxDate(),timeStr=new Date(dw.year,dw.month-1,1),startDay=timeStr.getDay(),dayStr="";if(0<startDay){timeStr.setMonth(timeStr.getMonth()-1);for(var prevDateWrap=dp.getDateWrap(timeStr),t=prevDateWrap.days-startDay+1;t<=prevDateWrap.days;t++)dayStr+='<dd class="other '+(_ctrClass=minDate<=(_date=new Date(dw.year,dw.month-2,t))&&_date<=maxDate?"":"disabled")+'" chMonth="-1" day="'+t+'">'+t+"</dd>"}for(t=1;t<=dw.days;t++){var _ctrClass=minDate<=(_date=new Date(dw.year,dw.month-1,t))&&_date<=maxDate?"":"disabled";t==dw.day?dayStr+='<dd class="slt '+_ctrClass+'" day="'+t+'">'+t+"</dd>":dayStr+='<dd class="'+_ctrClass+'" day="'+t+'">'+t+"</dd>"}for(var _date,t=1;t<=42-startDay-dw.days;t++)dayStr+='<dd class="other '+(_ctrClass=minDate<=(_date=new Date(dw.year,dw.month,t))&&_date<=maxDate?"":"disabled")+'" chMonth="1" day="'+t+'">'+t+"</dd>";var $hour,$minute,$second,$inputs,$days=$(setting.days$).html(dayStr).find("dd");$days.not(".disabled").click(function(){var $day=$(this);dp.hasTime()?($days.removeClass("slt"),$day.addClass("slt")):($this.val(dp.formatDate(dp.changeDay($day.attr("day"),$day.attr("chMonth")))),closeCalendar())}),dp.hasDate()||$(setting.main$).addClass("nodate"),dp.hasTime()&&($("#calendar .time").show(),$hour=dw.hour,$minute=dw.minute,$second=dw.second,dp.opts.defaultTime&&!$this.val()&&(timeStr=dp.opts.defaultTime.split(":"),$hour=parseInt(timeStr[0]),$minute=parseInt(timeStr[1]),$second=parseInt(timeStr[2])),$minute=parseInt($minute/dp.opts.mmStep)*dp.opts.mmStep,$second=dp.hasSecond()?$second:0,$hour=$(setting.hour$).val($hour).focus(function(){changeTmMenu("hh")}),$minute=$(setting.minute$).val($minute).attr("step",dp.opts.mmStep).focus(function(){changeTmMenu("mm")}),$second=$(setting.second$).val($second).attr("step",dp.opts.ssStep).focus(function(){changeTmMenu("ss")}),$hour.add($minute).add($second).click(function(){return!1}),clickTmMenu($hour,"hh"),clickTmMenu($minute,"mm"),clickTmMenu($second,"ss"),$(setting.box$).click(function(){changeTmMenu()}),($inputs=$(setting.tmInputs$)).keydown(keydownInt).each(function(){var $input=$(this);$input.keyup(function(){changeTm($input,0)})}),$(setting.tmUp$).click(function(){$inputs.filter(".slt").each(function(){changeTm($(this),1)})}),$(setting.tmDown$).click(function(){$inputs.filter(".slt").each(function(){changeTm($(this),-1)})}),dp.hasHour()||$hour.attr("disabled",!0),dp.hasMinute()||$minute.attr("disabled",!0),dp.hasSecond()||$second.attr("disabled",!0))}function closeCalendar(){$(setting.box$).remove(),$(document).off("click",null,closeCalendar)}$this.click(function(event){closeCalendar();var dp=new Datepicker($this.val(),opts),offset=$this.offset(),iTop=offset.top+this.offsetHeight;$($.parseHTML(JUI.frag.calendarFrag,document,!0)).appendTo("body").css({left:offset.left+"px",top:iTop+"px"}).show().click(function(event){event.stopPropagation()});var dayNames="";$.each($.regional.datepicker.dayNames,function(i,v){dayNames+="<dt>"+v+"</dt>"}),$(setting.dayNames$).html(dayNames);var dw=dp.getDateWrap(),$year=$(setting.year$),iBoxH=dp.getMinDate().getFullYear(),yearend=dp.getMaxDate().getFullYear();for(y=iBoxH;y<=yearend;y++)$year.append('<option value="'+y+'"'+(dw.year==y?'selected="selected"':"")+">"+y+"</option>");var $month=$(setting.month$);$.each($.regional.datepicker.monthNames,function(m,v){m+=1;$month.append('<option value="'+m+'"'+(dw.month==m?'selected="selected"':"")+">"+v+"</option>")}),generateCalendar(dp),$year.add($month).change(function(){dp.changeDate($year.val(),$month.val()),generateCalendar(dp)});iBoxH=$(setting.box$).outerHeight(!0);return iBoxH<iTop&&iTop>$(window).height()-iBoxH&&$(setting.box$).css("top",offset.top-iBoxH),$(setting.close$).click(function(){closeCalendar()}),$(setting.clearBut$).click(function(){$this.val(""),closeCalendar()}),$(setting.okBut$).click(function(){var date=$(setting.days$).find("dd.slt");if(date.hasClass("disabled"))return!1;date=dp.changeDay(date.attr("day"),date.attr("chMonth"));dp.hasTime()&&(date.setHours(parseInt($(setting.hour$).val())),date.setMinutes(parseInt($(setting.minute$).val())),date.setSeconds(parseInt($(setting.second$).val()))),$this.val(dp.formatDate(date)),closeCalendar()}),$(document).on("click",null,null,closeCalendar),!1}),$this.next().is(setting.calIcon$)&&$this.next().click(function(){return $this.trigger("click"),!1})})};var Datepicker=function(sDate,now){this.opts=$.extend({pattern:"yyyy-MM-dd",minDate:"1970-01-01",maxDate:"2099-12-31",mmStep:1,ssStep:1},now);now=new Date;this.opts.minDate=now.formatDateTm(this.opts.minDate),this.opts.maxDate=now.formatDateTm(this.opts.maxDate),this.sDate=sDate.trim()};$.extend(Datepicker.prototype,{get:function(name){return this.opts[name]},_getDays:function(y,m){return 2==m?y%4||!(y%100)&&y%400?28:29:/4|6|9|11/.test(m)?30:31},_minMaxDate:function(sDate){var _count=sDate.split("-").length-1,_format="y-M-d";return 1==_count?_format="y-M":0==_count&&(_format="y"),sDate.parseDate(_format)},getMinDate:function(){return this._minMaxDate(this.opts.minDate)},getMaxDate:function(){var _day=this.opts.maxDate,_count=_day.split("-").length-1,_date=this._minMaxDate(_day);return _count<2&&(_day=this._getDays(_date.getFullYear(),_date.getMonth()+1),_date.setDate(_day),0==_count&&_date.setMonth(11)),_date},getDateWrap:function(date){var y=(date=date||(this.parseDate(this.sDate)||new Date)).getFullYear(),m=date.getMonth()+1,days=this._getDays(y,m);return{year:y,month:m,day:date.getDate(),hour:date.getHours(),minute:date.getMinutes(),second:date.getSeconds(),days:days,date:date}},changeDate:function(y,m,date){date=new Date(y,m-1,date||1);return this.sDate=this.formatDate(date),date},changeDay:function(day,chMonth){chMonth=chMonth||0;var dw=this.getDateWrap();return this.changeDate(dw.year,dw.month+parseInt(chMonth),day)},parseDate:function(sDate){return sDate?sDate.parseDate(this.opts.pattern):null},formatDate:function(date){return date.formatDate(this.opts.pattern)},hasHour:function(){return-1!=this.opts.pattern.indexOf("H")},hasMinute:function(){return-1!=this.opts.pattern.indexOf("m")},hasSecond:function(){return-1!=this.opts.pattern.indexOf("s")},hasTime:function(){return this.hasHour()||this.hasMinute()||this.hasSecond()},hasDate:function(){for(var _dateKeys=["y","M","d","E"],i=0;i<_dateKeys.length;i++)if(-1!=this.opts.pattern.indexOf(_dateKeys[i]))return!0;return!1}})}(jQuery),function($){$.scrollPosParents=function($el){var $el=$($el),scrollPos={top:0,left:0};return $el.parents().each(function(){var $p=$(this);scrollPos.top+=$p.scrollTop(),scrollPos.left+=$p.scrollLeft()}),scrollPos},$.fn.jDrag=function(options){return"string"==typeof options&&"destroy"==options?this.each(function(){$(this).off("mousedown",null,$.rwdrag.start),$.data(this,"pp-rwdrag",null)}):this.each(function(){var select=$(this);$.data($.rwdrag,"pp-rwdrag",{options:$.extend({el:select,obj:select},options)}),options.event?$.rwdrag.start(options.event):(select=options.selector,$(select,obj).on("mousedown",null,null,$.rwdrag.start))})},$.rwdrag={start:function(e){document.onselectstart=function(e){return!1};var data=$.data(this,"pp-rwdrag"),el=data.options.el[0];$.data(el,"pp-rwdrag",{options:data.options}),$.rwdrag.current||($.rwdrag.current={el:el,oleft:parseInt(el.style.left)||0,otop:parseInt(el.style.top)||0,ox:e.pageX||e.screenX,oy:e.pageY||e.screenY},$(document).on("mouseup",null,null,$.rwdrag.stop).on("mousemove",null,null,$.rwdrag.drag))},drag:function(e){e=e||window.event;var selector,current=$.rwdrag.current,data=$.data(current.el,"pp-rwdrag"),left=current.oleft+(e.pageX||e.clientX)-current.ox,top=current.otop+(e.pageY||e.clientY)-current.oy;return"horizontal"==data.options.move?(data.options.minW&&left>=$(data.options.obj).cssv("left")+data.options.minW&&data.options.maxW&&left<=$(data.options.obj).cssv("left")+data.options.maxW||data.options.scop&&(!data.options.relObj||left-parseInt(data.options.relObj.style.left)>data.options.cellMinW))&&(current.el.style.left=left+"px"):"vertical"==data.options.move?current.el.style.top=top+"px":left>=2*-(selector=data.options.selector?$(data.options.selector,data.options.obj):$(data.options.obj)).outerWidth()/3&&left+selector.outerWidth()/3<$(window).width()&&top+selector.outerHeight()<$(window).height()&&(current.el.style.left=left+"px",current.el.style.top=top+"px"),data.options.drag&&data.options.drag.apply(current.el,[current.el,e]),$.rwdrag.preventEvent(e)},stop:function(e){var current=$.rwdrag.current,data=$.data(current.el,"pp-rwdrag");return $(document).off("mousemove",null,$.rwdrag.drag).off("mouseup",null,$.rwdrag.stop),data.options.stop&&data.options.stop.apply(current.el,[current.el,e]),$.rwdrag.current=null,document.onselectstart=function(e){return!0},$.rwdrag.preventEvent(e)},preventEvent:function(e){return e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),!1}}}(jQuery),function($){var _op={cursor:"move",sortBoxs:"div.sortDrag",items:">.dragItem",selector:"",zIndex:1e3};JUI.sortDrag={_onDrag:!1,start:function($sortBox,$item,event,op){var me=this;if(me._onDrag)return setTimeout(function(){me._onDrag=!1},500),!1;me._onDrag=!0;var $placeholder=this._createPlaceholder($item),$helper=$item.clone(),position=$item.position();$.scrollPosParents($sortBox);return $helper.data("$sortBox",$sortBox).data("op",op).data("$item",$item).data("$placeholder",$placeholder),$helper.addClass("sortDragHelper").css({position:"absolute",top:position.top,left:position.left,zIndex:op.zIndex,width:$item.width()+"px",height:$item.height()+"px"}).jDrag({selector:op.selector,drag:this.drag,stop:this.stop,event:event}),$item.before($placeholder).before($helper).hide(),!1},drag:function(el,event){var $helper=$(el),$sortBox=$helper.data("$sortBox"),$placeholder=$helper.data("$placeholder"),$items=$sortBox.find($helper.data("op").items).filter(":visible").filter(":not(.sortDragPlaceholder, .sortDragHelper)"),helperPos=$helper.position(),$overBox=JUI.sortDrag._getOverSortBox($helper);if(1==$sortBox.data("over-sort")&&0<$overBox.length&&$overBox[0]!=$sortBox[0])$placeholder.appendTo($overBox),$helper.data("$sortBox",$overBox);else if($items.length)for(var i=0;i<$items.length;i++){var $this=$items.eq(i),position=$this.position();if(helperPos.top>position.top+10)$this.after($placeholder);else if(helperPos.top<=position.top||helperPos.left<=position.left){$this.before($placeholder);break}}},stop:function(){var $helper=$(arguments[0]),$item=$helper.data("$item"),$placeholder=$helper.data("$placeholder");$item.insertAfter($placeholder).show(),$placeholder.remove(),$helper.remove(),JUI.sortDrag._onDrag=!1},_createPlaceholder:function($item){return $("<"+$item[0].nodeName+' class="sortDragPlaceholder"/>').css({width:$item.outerWidth()+"px",height:$item.outerHeight()+"px",marginTop:$item.css("marginTop"),marginRight:$item.css("marginRight"),marginBottom:$item.css("marginBottom"),marginLeft:$item.css("marginLeft")})},_getOverSortBox:function($item){var op=$item.offset(),y=op.top,x=op.left+$item.width()/2,op=$.extend({},_op,$item.data("op"));return $(op.sortBoxs).filter(":visible").filter(function(){var $sortBox=$(this);return!$sortBox.data("accept")||-1<$sortBox.data("accept").split(",").indexOf($item.data("type"))}).filter(function(){var sortBoxW=$(this),sortBoxPos=sortBoxW.offset(),sortBoxH=sortBoxW.height(),sortBoxW=sortBoxW.width();return JUI.isOver(y,x,sortBoxPos.top,sortBoxPos.left,sortBoxH,sortBoxW)})}},$.fn.sortDrag=function(options){return this.each(function(){var op=$.extend({},_op,options),$sortBox=$(this);$sortBox.attr("selector")&&(op.selector=$sortBox.attr("selector")),$sortBox.find(op.items).each(function(i){var $item=$(this),$selector=$item;op.selector&&($selector=$item.find(op.selector).css({cursor:op.cursor})),op.refresh&&$selector.off("mousedown"),$selector.mousedown(function(event){$sortBox.hasClass("disabled")||$(event.target).is("input")||$(event.target).is("a")||(JUI.sortDrag.start($sortBox,$item,event,op),event.preventDefault())})}),$sortBox.find(".close").mousedown(function(event){return $(this).parent().remove(),!1})})}}(jQuery),function($){JUI.miscDrag={start:function($sortBox,$item,event,op){var $helper=$item.clone(),position=$item.position();return $helper.addClass("sortDragHelper").css({position:"absolute",top:position.top+$sortBox.scrollTop(),left:position.left,zIndex:op.zIndex,minWidth:$item.width()+"px",height:$item.height()+"px"}).jDrag({drag:this.drag,stop:this.stop,event:event}),$helper.data("$sortBox",$sortBox),$item.before($helper),!1},drag:function(el,event){},stop:function(el,event){var $dragBox,id,sequence,overBoxPos,$helper=$(el),rel=$helper.data("$sortBox"),dragBoxPos=JUI.miscDrag._getOverSortBox($helper);0<dragBoxPos.length?(($dragBox=$helper.appendTo(dragBoxPos).mousedown(function(event){$(this).jDrag({event:event})})).html(),$dragBox.data("icon"),id=$dragBox.data("id"),sequence=dragBoxPos.find("> div").length,overBoxPos=dragBoxPos.position(),dragBoxPos=$dragBox.position(),$dragBox.css({height:"auto",top:dragBoxPos.top-overBoxPos.top+"px",left:dragBoxPos.left-overBoxPos.left+"px"}),(rel=rel.attr("rel"))&&$('<div class="sortDrag" data-id="'+id+'"><h2>'+sequence+"</h2></div>").appendTo(rel)):$helper.remove()},_getOverSortBox:function($item){var op=$item.offset(),y=op.top+$item.height()/2,x=op.left+$item.width()/2,op=$item.data("op");return $(op.sortBoxs).filter(":visible").filter(function(){var $sortBox=$(this);return!$sortBox.data("accept")||-1<$sortBox.data("accept").split(",").indexOf($item.data("type"))}).filter(function(){var sortBoxW=$(this),sortBoxPos=sortBoxW.offset(),sortBoxH=sortBoxW.height(),sortBoxW=sortBoxW.width();return JUI.isOver(y,x,sortBoxPos.top,sortBoxPos.left,sortBoxH,sortBoxW)})},_createPlaceholder:function($item){return $("<"+$item[0].nodeName+' class="sortDragPlaceholder"/>').css({height:$item.outerHeight()+"px",marginTop:$item.css("marginTop"),marginRight:$item.css("marginRight"),marginBottom:$item.css("marginBottom"),marginLeft:$item.css("marginLeft")})},startSortDrag:function($sortBox,$item,event,op){var $placeholder=this._createPlaceholder($item),$helper=$item.clone(),position=$item.position();return $helper.data("$sortBox",$sortBox).data("op",op).data("$item",$item).data("$placeholder",$placeholder),$helper.addClass("sortDragHelper").css({position:"absolute",top:position.top+$sortBox.scrollTop(),left:position.left,zIndex:op.zIndex,width:$item.width()+"px",height:$item.height()+"px"}).jDrag({drag:this.dragSortDrag,stop:this.stopSortDrag,event:event}),$item.before($helper).before($placeholder),!1},dragSortDrag:function(el,event){var $helper=$(el),$sortBox=$helper.data("$sortBox"),$placeholder=$helper.data("$placeholder"),$overBox=$helper.parents(".unitBox:first"),position=$helper.position();$helper.css({top:position.top+$overBox.scrollTop()});$overBox=JUI.miscDrag._getOverSortBox($helper);if(0<$overBox.length&&$overBox[0]!=$sortBox[0]){var $items=$overBox.find(">.dragItem").filter(":visible").filter(":not(.sortDragPlaceholder, .sortDragHelper)");if($items.length){helperPos=$helper.offset();for(var i=0;i<$items.length;i++){var $this=$items.eq(i),position=$this.offset();if(helperPos.top>position.top+10)$this.after($placeholder);else if(helperPos.top<=position.top||helperPos.left<=position.left){$this.before($placeholder);break}}}else $placeholder.appendTo($overBox)}},stopSortDrag:function(){var $destBox,$result,$helper=$(arguments[0]),$sortBox=$helper.data("$sortBox"),$placeholder=$helper.data("$placeholder"),$item=$helper.data("$item");$placeholder&&$placeholder.is(":visible")?($destBox=$placeholder.parents(".sortDrag:first"),$result=$helper.html(),($result=$('<div class="dragItem">'+$result+"</div>")).attr("data-id",$helper.data("id")),$result.attr("data-type",$helper.data("type")),$result.insertAfter($placeholder).show(),$placeholder.remove(),$helper.remove(),1!=$sortBox.data("duplicate")&&$item.remove(),$.fn.sortDrag&&$destBox.sortDrag({refresh:!0})):($placeholder.remove(),$helper.remove())}},$.fn.extend({miscDrag:function(options){var op=$.extend({cursor:"move",sortBoxs:"div.miscDrag",items:"> dt .dragBox",zIndex:1e3},options);return this.each(function(){var $box=$(this);$box.find(op.items).each(function(i){var $item=$(this);$item.mousedown(function(event){JUI.miscDrag.start($box,$item,event,op),event.preventDefault()})})})},miscDragData:function(){for(var $miscDrag=$(this),$miscSortDrag=$($miscDrag.attr("rel")),$dragBoxList=$miscDrag.find("dd .dragBox"),$sortDragList=$miscSortDrag.find(".sortDrag"),data=[],i=0;i<$dragBoxList.length;i++){var $dragBox=$dragBoxList.eq(i),$sortDrag=$sortDragList.eq(i),$dragBoxPos=$dragBox.position(),dataItem={id:$dragBox.data("id"),top:parseInt($dragBoxPos.top),left:parseInt($dragBoxPos.left),items:[]};$sortDrag.find(".dragItem").each(function(index){var $dragItem=$(this);$dragItem.position();dataItem.items.push({id:$dragItem.data("id")})}),data.push(dataItem)}return data},miscSortDragData:function(){var $miscSortDrag=$(this);return function fillData($sortDragList){for(var data=[],i=0;i<$sortDragList.length;i++){var $sortDrag=$sortDragList.eq(i),dataItem={items:[]};$sortDrag.data("id")&&(dataItem.id=$sortDrag.data("id")),$sortDrag.find(">.dragItem").each(function(){var $dragItem=$(this),itemData={id:$dragItem.data("id")};$dragItem.find(">.ctl-label>:input").each(function(){var $lable=$(this),lableName=$lable.data("name");lableName&&("checkbox"==$lable.attr("type")?itemData[lableName]=$lable.is(":checked"):itemData[lableName]=$lable.val())}),$dragItemSortDragList=$dragItem.find(">.ctl-label .sortDrag"),$dragItemSortDragList.length&&(itemData.items=fillData($dragItemSortDragList)),dataItem.items.push(itemData)}),data.push(dataItem)}return data}($miscSortDrag.find(".sortDrag[data-parent="+$miscSortDrag.data("id")+"]"))},miscSortDrag:function(options){var op=$.extend({cursor:"move",sortBoxs:"dl.miscSortDrag .sortDrag",items:"> dt .dragItem",zIndex:1e3},options);return this.each(function(){var $sortBox=$(this);$sortBox.find(op.items).each(function(i){var $item=$(this);$item.mousedown(function(event){JUI.miscDrag.startSortDrag($sortBox,$item,event,op),event.preventDefault()})})})}})}(jQuery),function($){$.extend($.fn,{jTree:function(options){var op=$.extend({checkFn:null,selected:"selected",exp:"expandable",coll:"collapsable",firstExp:"first_expandable",firstColl:"first_collapsable",lastExp:"last_expandable",lastColl:"last_collapsable",folderExp:"folder_expandable",folderColl:"folder_collapsable",endExp:"end_expandable",endColl:"end_collapsable",file:"file",ck:"checked",unck:"unchecked",async:"_src"},options);return this.each(function(){var $this=$(this),cnum=$this.children().length;$(">li",$this).each(function(){var $li=$(this),first=!$li.prev()[0],last=!$li.next()[0];$li.genTree({root:$this,icon:$this.hasClass("treeFolder"),ckbox:$this.hasClass("treeCheck"),excludeParent:$this.hasClass("excludeParent"),options:op,level:0,exp:1<cnum?first?op.firstExp:last?op.lastExp:op.exp:op.endExp,coll:1<cnum?first?op.firstColl:last?op.lastColl:op.coll:op.endColl,showSub:!$this.hasClass("collapse")&&($this.hasClass("expand")||!(1<cnum)),isLast:!(1<cnum)||last})}),setTimeout(function(){var checkFn;$this.hasClass("treeCheck")&&(checkFn=eval($this.attr("oncheck")),checkFn&&"function"==typeof checkFn&&$("div.ckbox",$this).each(function(){var ckbox=$(this);ckbox.click(function(){var boxes,checked=$(ckbox).hasClass("checked"),items=[];return checked&&(boxes=$(ckbox).parent().parent(),1<(boxes=$("input",boxes)).length?$(boxes).each(function(){items[items.length]={name:$(this).attr("name"),value:$(this).val()}}):items={name:boxes.attr("name"),value:boxes.val()}),checkFn({checked:checked,items:items}),!1})})),$("a",$this).click(function(event){$("div."+op.selected,$this).removeClass(op.selected);var parent=$(this).parent().addClass(op.selected),$li=$(this).parents("li:first"),sTarget=$li.attr("target");if(sTarget&&(0==$("#"+sTarget,$this).length&&$this.prepend('<input id="'+sTarget+'" type="hidden" />'),$("#"+sTarget,$this).val($li.attr("rel"))),$(".ckbox",parent).trigger("click"),event.stopPropagation(),$(document).trigger("click"),!$(this).attr("target"))return!1})},1)})},subTree:function(op,level){return this.each(function(){$(">li",this).each(function(){var $this=$(this),isLast=!$this.next()[0];$this.genTree({root:op.root,icon:op.icon,ckbox:op.ckbox,excludeParent:op.excludeParent,exp:isLast?op.options.lastExp:op.options.exp,coll:isLast?op.options.lastColl:op.options.coll,options:op.options,level:level,space:isLast?null:op.space,showSub:op.showSub,isLast:isLast})})})},genTree:function(options){var op=$.extend({root:options.root,icon:options.icon,ckbox:options.ckbox,excludeParent:options.excludeParent,exp:"",coll:"",showSub:!1,level:0,options:null,isLast:!1},options);return this.each(function(){var node=$(this),tree=$(">ul",node),parent=node.parent().prev(),checked="unchecked";op.ckbox&&$(">.checked",parent).length<0&&(checked="checked"),0<tree.length||node.attr(op.options.async)?(node.children(":first").wrap("<div></div>"),$(">div",node).prepend((op.ckbox?"<div class='ckbox "+checked+"'></div>":"")+(op.icon?"<div class='"+(op.showSub&&!node.attr(op.options.async)?op.options.folderColl:op.options.folderExp)+"'></div>":"<div class='"+(op.showSub&&!node.attr(op.options.async)?op.coll:op.exp)+"'></div>")),0<tree.length&&(op.showSub?tree.show():tree.hide()),$(">div>div."+op.options.folderColl+",>div>div."+op.options.folderExp+",>div>a",node).click(function(){if(node.attr(op.options.async)&&($.ajax({type:"get",url:node.attr(op.options.async),async:!1,data:{},success:function(response){node.append(response),initLink(tree=$(">ul",node).hide()),$("a",tree).click(function(event){$("div."+op.options.selected,op.root).removeClass(op.options.selected);var parent=$(this).parent().addClass(op.options.selected),$li=$(this).parents("li:first"),sTarget=$li.attr("target");if(sTarget&&(0==$("#"+sTarget,op.root).length&&op.root.prepend('<input id="'+sTarget+'" type="hidden" />'),$("#"+sTarget,op.root).val($li.attr("rel"))),$(".ckbox",parent).trigger("click"),event.stopPropagation(),$(document).trigger("click"),!$(this).attr("target"))return!1}),node.removeAttr(op.options.async)},error:JUI.ajaxError}),node.attr(op.options.async)))return!1;$(">li:first",tree).children(":first").isTag("a")&&tree.subTree(op,op.level+1);var isA=$(this).isTag("a"),$this=$(">div>div."+op.coll+",>div>div."+op.exp,node);return isA&&!tree.is(":hidden")||($this.toggleClass(op.exp).toggleClass(op.coll),op.icon&&$(">div>div:last",node).toggleClass(op.options.folderExp).toggleClass(op.options.folderColl)),tree.is(":hidden")?tree.slideDown(100):isA||tree.slideUp(100),!1}),addSpace(op.level,node),op.showSub&&tree.subTree(op,op.level+1)):(node.children().wrap("<div></div>"),$(">div",node).prepend((op.ckbox?"<div class='ckbox "+checked+"'></div>":"")+(op.icon?"<div class='"+op.options.file+"'></div>":"<div class='node'></div>")),op.icon&&$(">div>div."+op.options.file,node).click(function(){return $(this).next().click(),!1}),addSpace(op.level,node)),op.ckbox&&node._check(op),$.support.leadingWhitespace||$(">div",node).click(function(){return $("a",this).trigger("click"),!1})});function addSpace(level,node){if(0<level){var parent=node.parent().parent(),plist="<div class='"+(parent.next()[0]?"line":"indent")+"'></div>";if(1<level){for(var next=$(">div>div",parent).filter(":first"),prev="";1<level;)prev=prev+"<div class='"+next.attr("class")+"'></div>",next=next.next(),level--;plist=prev+plist}$(">div",node).prepend(plist)}}},_check:function(op){var node=$(this),ckbox=$(">div>.ckbox",node),$input=node.find("a"),tname=$input.attr("tname"),tvalue=$input.attr("tvalue"),attrs="";tname&&(attrs+="name='"+tname+"' "),tvalue&&(attrs+="value='"+tvalue+"' "),ckbox.append("<input type='checkbox' style='display:none;' "+attrs+"/>").click(function(){var cked=ckbox.hasClass("checked"),aClass=cked?"unchecked":"checked",rClass=cked?"checked":"unchecked";return ckbox.removeClass(rClass).removeClass(cked?"":"indeterminate").addClass(aClass),$("input",ckbox).prop("checked",!cked),$(">ul",node).find("li").each(function(){$("div.ckbox",this).removeClass(rClass).removeClass(cked?"":"indeterminate").addClass(aClass).find("input").prop("checked",!cked)}),$(node)._checkParent(op.excludeParent),!1}),$input.attr("checked")&&(ckbox.find("input").prop("checked",!0),ckbox.removeClass("unchecked").addClass("checked"),$(node)._checkParent(op.excludeParent))},_checkParent:function(excludeParent){var parent,ckbox,aClass,$checkbox;$(this).parent().hasClass("tree")||(parent=$(this).parent().parent(),ckbox=(aClass=$(">ul",parent)).find(">li>a").length+aClass.find("div.ckbox").length,aClass=($checkbox=aClass.find("div.checked").length)==ckbox?"checked":0!=$checkbox?"indeterminate":"unchecked",$checkbox=$checkbox!=ckbox&&0!=$checkbox?"checked":"indeterminate",$(">div>.ckbox",parent).removeClass("unchecked").removeClass("checked").removeClass($checkbox).addClass(aClass),$checkbox=$(":checkbox",parent),"checked"==aClass?($checkbox.prop("checked",!0),$(">div>.ckbox",parent).find("input").prop("checked",!0)):"unchecked"==aClass?$checkbox.removeAttr("checked"):"indeterminate"!=aClass||excludeParent||$(">div>.ckbox",parent).find("input").prop("checked",!0),parent._checkParent(excludeParent))}})}(jQuery),function($){var jmenus=new Map;function completed(cancel){var options;$.data(this,"jui-accordion")&&((options=$.data(this,"jui-accordion").options).running=cancel?0:--options.running,options.running||(options.clearStyle&&options.toShow.add(options.toHide).css({height:"",overflow:""}),$(this).triggerHandler("change.jui-accordion",[options.data],options.change)))}function toggle(toShow,toHide,complete,clickedActive,down){var options=$.data(this,"jui-accordion").options;options.toShow=toShow,options.toHide=toHide,options.data=complete;var callback,scope,complete=(callback=completed,scope=this,function(){return callback.apply(scope,arguments)});options.running=(0==toHide.length?toShow:toHide).length,options.animated?!options.alwaysOpen&&clickedActive?$.jui.accordion.animations[options.animated]({toShow:jQuery([]),toHide:toHide,complete:complete,down:down,autoheight:options.autoheight}):$.jui.accordion.animations[options.animated]({toShow:toShow,toHide:toHide,complete:complete,down:down,autoheight:options.autoheight}):(!options.alwaysOpen&&clickedActive?toShow.toggle():(toHide.hide(),toShow.show()),complete(!0))}function clickHandler(down){var options=$.data(this,"jui-accordion").options;if(options.disabled)return!1;if(!down.target&&!options.alwaysOpen){options.active.find("h2").toggleClass(options.selectedClass),options.active.find("h2 .icon").toggleClass(options.selectedIconClass);var toHide=options.active.next(),data={instance:this,options:options,newHeader:jQuery([]),oldHeader:options.active,newContent:jQuery([]),oldContent:toHide},toShow=options.active=$([]);return toggle.call(this,toShow,toHide,data),!1}var clicked=$(down.target);if(clicked.parents(options.header).length)for(;!clicked.is(options.header);)clicked=clicked.parent();var clickedActive=clicked[0]==options.active[0];if(options.running||options.alwaysOpen&&clickedActive)return!1;if(clicked.is(options.header)){options.active.find("h2").toggleClass(options.selectedClass),options.active.find("h2 .icon").toggleClass(options.selectedIconClass),clickedActive||(clicked.find("h2").addClass(options.selectedClass),clicked.find("h2 .icon").toggleClass(options.selectedIconClass));toShow=clicked.next(),toHide=options.active.next(),data={instance:this,options:options,newHeader:clicked,oldHeader:options.active,newContent:toShow,oldContent:toHide},down=options.headers.index(options.active[0])>options.headers.index(clicked[0]);return options.active=clickedActive?$([]):clicked,toggle.call(this,toShow,toHide,data,clickedActive,down),!1}}function findActive(headers,selector){return null!=selector?"number"==typeof selector?headers.filter(":eq("+selector+")"):headers.not(headers.not(selector)):!1===selector?$([]):headers.filter(":eq(0)")}$.jui=$.jui||{},$.fn.extend({accordion:function(options,data){var args=Array.prototype.slice.call(arguments,1);return this.each(function(){var accordion;options.fillSpace&&jmenus.put(options.fillSpace,this),"string"==typeof options?(accordion=$.data(this,"jui-accordion"))[options].apply(accordion,args):$(this).is(".jui-accordion")||$.data(this,"jui-accordion",new $.jui.accordion(this,options))})},activate:function(index){return this.accordion("activate",index)}}),$.jui.accordion=function(container,options){var maxHeight,parent,height,os,obj;this.options=options=$.extend({},$.jui.accordion.defaults,options),this.element=container,$(container).addClass("jui-accordion"),options.headers=$(container).find(options.header),options.active=findActive(options.headers,options.active),options.fillSpace?(parent=options.fillSpace,(obj=jmenus.get(parent))&&(parent=$(obj).parent(),height=parent.height()-$(".accordionHeader",obj).length*$(".accordionHeader:first-child",obj).outerHeight()-2,os=parent.children().not(obj),$.each(os,function(i){height-=$(os[i]).outerHeight()}),$(".accordionContent",obj).height(height))):options.autoheight&&(maxHeight=0,options.headers.next().each(function(){maxHeight=Math.max(maxHeight,$(this).outerHeight())}).height(maxHeight)),options.headers.not(options.active||"").next().hide(),options.active.find("h2").addClass(options.selectedClass),options.active.find("h2 .icon").addClass(options.selectedIconClass),options.event&&$(container).on(options.event+".jui-accordion",null,null,clickHandler)},$.jui.accordion.prototype={activate:function(index){clickHandler.call(this.element,{target:findActive(this.options.headers,index)[0]})},enable:function(){this.options.disabled=!1},disable:function(){this.options.disabled=!0},destroy:function(){this.options.headers.next().css("display",""),(this.options.fillSpace||this.options.autoheight)&&this.options.headers.next().css("height",""),$.removeData(this.element,"jui-accordion"),$(this.element).removeClass("jui-accordion").off(".jui-accordion")}},$.extend($.jui.accordion,{defaults:{selectedClass:"collapsable",selectedIconClass:"icon-chevron-down",alwaysOpen:!0,animated:"slide",event:"click",header:".accordionHeader",autoheight:!0,running:0,clearStyle:!0},animations:{slide:function(options,additions){var hideHeight,showHeight,difference;(options=$.extend({easing:"swing",duration:100},options,additions)).toHide.length?(hideHeight=options.toHide.height(),showHeight=options.toShow.height(),difference=showHeight/hideHeight,options.toShow.css({height:"0px"}).show(),options.toHide.filter(":hidden").each(options.complete).end().filter(":visible").animate({height:"hide"},{step:function(current){current=(hideHeight-current)*difference;$.support.leadingWhitespace||(current=Math.ceil(current)),options.toShow.height(current)},duration:options.duration,easing:options.easing,complete:function(){options.toShow.css({height:showHeight+"px"}),options.toShow.css({overflow:"auto"}),options.complete()}})):options.toShow.animate({height:"show"},options)},bounceslide:function(options){this.slide(options,{easing:options.down?"bounceout":"swing",duration:options.down?200:100})},easeslide:function(options){this.slide(options,{easing:"easeinout",duration:100})}}})}(jQuery),function($){$.fn.navMenu=function(callback){return this.each(function(){var $box=$(this),$callback=callback;$box.find("li>a").click(function(){var $a=$(this);return $a.is("[href^=javascript]")||$("#sidebar #menu").ajaxUrl({type:"get",url:$a.attr("href"),callback:function(response){$box.find("li").removeClass("selected"),$a.parent().addClass("selected"),$callback&&($callback(),$callback=null)}}),!1})})}}(jQuery),function($){var menu,hash;function hide(){menu.hide()}$.fn.extend({contextMenu:function(id,op){op=$.extend({bindings:{},ctrSub:null},op);menu=menu||$('<div id="contextmenu"></div>').appendTo("body").hide(),(hash=hash||[]).push({id:id,bindings:op.bindings||{},ctrSub:op.ctrSub});var index=hash.length-1;return $(this).on("contextmenu",null,null,function(e){return function(posX,trigger,posY){var cur=hash[posX],posX=$(JUI.frag[cur.id]);posX.find("li"),menu.html(posX),$.each(cur.bindings,function(id,func){$("[rel='"+id+"']",menu).on("click",null,null,function(e){hide(),func($(trigger),$("#"+cur.id))})});posX=posY.pageX,posY=posY.pageY;$(window).width()<posX+menu.width()&&(posX-=menu.width());$(window).height()<posY+menu.height()&&(posY-=menu.height());menu.css({left:posX+"px",top:posY+"px"}).show(),$(document).one("click",hide),"function"==typeof cur.ctrSub&&cur.ctrSub($(trigger),$("#"+cur.id))}(index,this,e),!1}),this}})}(jQuery),function($){$.fn.cssv=function(cssPre){cssPre=$(this).css(cssPre);return+cssPre.substring(0,cssPre.indexOf("px"))},$.fn.jBar=function(options){var op=$.extend({container:"#navTab",containerHeader:"#navTab .tabsPageHeader",toggleBut:".toggleCollapse",sideBar:"#sidebar",sideBar2:"#sidebar_s",splitBar:"#splitBar",splitBar2:"#splitBarProxy",iconClass:"icon-chevron-sign-right"},options);return this.each(function(){var sbar=$(op.sideBar2,this),bar=$(op.sideBar,this);$(op.toggleBut).click(function(){var barleft,cleft,cwidth;return $(op.splitBar).is(":visible")?(JUI.ui.sbar=!1,$(".icon",op.toggleBut).addClass(op.iconClass),$(op.splitBar).hide(),barleft=sbar.outerWidth()-bar.outerWidth(),cleft=$(op.container).cssv("margin-left")-bar.outerWidth(),cwidth=bar.outerWidth()+$(op.container).outerWidth(),$(op.containerHeader).animate({"margin-left":sbar.outerWidth()},50),sbar.show().css("left",0),$(op.container).animate({"margin-left":cleft,width:cwidth},50,function(){bar.animate({left:barleft,top:sbar.outerHeight()},50,function(){bar.hide(),bar.css("bottom","auto"),$(window).trigger(JUI.eventType.resizeGrid),$(window).trigger(JUI.eventType.resizeChart)})}),$(sbar).click(function(){return bar.is(":hidden")?(bar.show().animate({left:0},50),$(op.container).click(function _hideBar(){$(op.container).off("click",null,_hideBar);JUI.ui.sbar||bar.animate({left:barleft},50,function(){bar.hide()})})):bar.animate({left:barleft},50,function(){bar.hide()}),!1})):(JUI.ui.sbar=!0,$(".icon",op.toggleBut).removeClass(op.iconClass),sbar.css("left",-50),$(op.containerHeader).animate({"margin-left":0},80),bar.show().css("bottom",0).css("top",0).animate({left:0},80,function(){$(op.splitBar).show();var cleft=bar.outerWidth(),cwidth=$(op.container).outerWidth()-(cleft-$(op.container).cssv("margin-left"));$(op.container).css({"margin-left":cleft,width:cwidth}),$(sbar).off("click"),$(window).trigger(JUI.eventType.resizeGrid),$(window).trigger(JUI.eventType.resizeChart)})),!1}),$(op.splitBar).mousedown(function(event){$(op.splitBar2).each(function(){var spbar2=$(this);return setTimeout(function(){spbar2.show()},10),spbar2.css({visibility:"visible",left:$(op.splitBar).css("left")}),spbar2.jDrag($.extend(options,{obj:$("#sidebar"),move:"horizontal",event:event,stop:function(){$(this).css("visibility","hidden");var cwidth=$(this).cssv("left")-$(op.splitBar).cssv("left"),sbarwidth=bar.outerWidth()+cwidth,cleft=$(op.container).cssv("margin-left")+cwidth,cwidth=$(op.container).outerWidth()-cwidth-1;bar.css("width",sbarwidth),$(op.splitBar).css("left",$(this).css("left")),$(op.container).css({"margin-left":cleft,width:cwidth})}})),!1})})})}}(jQuery),function($){$.fn.extend({theme:function(options){function setTheme(themeName){$themeItem.attr("href",_themeHref.replace("#theme#",themeName)),jThemeLi.find(">div").removeClass("selected"),jThemeLi.filter("[theme="+themeName+"]").find(">div").addClass("selected"),"function"==typeof $.cookie&&$.cookie("dwz_theme",themeName)}var op=$.extend({themeBase:"themes",defaultTheme:"default"},options),_themeHref=op.themeBase+"#theme#.css",$themeItem=$('<link href="'+_themeHref.replace("#theme#",op.defaultTheme)+'" rel="stylesheet" media="screen"/>'),jThemeLi=$(this).find(">li[theme]");return jThemeLi.each(function(index){var $this=$(this),themeName=$this.attr("theme");themeName==op.defaultTheme&&$this.find(">div").addClass("selected"),$this.addClass(themeName).click(function(){setTheme(themeName)})}),"function"==typeof $.cookie&&$.cookie("dwz_theme")&&setTheme($.cookie("dwz_theme")),$themeItem.appendTo($("head")),this}})}(jQuery);var navTab={componentBox:null,_tabBox:null,_prevBut:null,_nextBut:null,_panelBox:null,_moreBut:null,_moreBox:null,_currentIndex:0,_op:{id:"navTab",step:4,stTabBox:".navTab-tab",stPanelBox:".navTab-panel",mainTabId:"main",close$:"a.close",prevClass:"tabsLeft",nextClass:"tabsRight",stMore:".tabsMore",stMoreLi:"ul.tabsMoreList"},init:function(options){$.History&&$.History.init();var $this=this;$.extend(this._op,options),this.componentBox=$("#"+this._op.id),this.step=this._op.step,this._tabBox=this.componentBox.find(this._op.stTabBox),this._panelBox=this.componentBox.find(this._op.stPanelBox),this._prevBut=this.componentBox.find("."+this._op.prevClass),this._nextBut=this.componentBox.find("."+this._op.nextClass),this._moreBut=this.componentBox.find(this._op.stMore),this._moreBox=this.componentBox.find(this._op.stMoreLi),this._prevBut.click(function(event){$this._scrollPrev()}),this._nextBut.click(function(event){$this._scrollNext()}),this._moreBut.click(function(){return $this._moreBox.show(),!1}),$(document).click(function(){$this._moreBox.hide()}),this._contextmenu(this._tabBox),this._contextmenu(this._getTabs()),this._init(),this._ctrlScrollBut()},_init:function(){var $this=this;this._getTabs().each(function(iTabIndex){$(this).off("click").click(function(event){$this._switchTab(iTabIndex)}),$(this).find(navTab._op.close$).off("click").click(function(){$this._closeTab(iTabIndex)})}),this._getMoreLi().each(function(iTabIndex){$(this).find(">a").off("click").click(function(event){$this._switchTab(iTabIndex)})}),this._switchTab(this._currentIndex)},_contextmenu:function($obj){var $this=this;$obj.contextMenu("navTabCM",{bindings:{reload:function(t,m){$this._reload(t,!0)},closeCurrent:function(tabId,m){tabId=tabId.attr("tabid");tabId?$this.closeTab(tabId):$this.closeCurrentTab()},closeOther:function(index,m){index=$this._indexTabId(index.attr("tabid"));$this._closeOtherTab(0<index?index:$this._currentIndex)},closeAll:function(t,m){$this.closeAllTab()}},ctrSub:function(t,$tabLi){var mReload=$tabLi.find("[rel='reload']"),mCur=$tabLi.find("[rel='closeCurrent']"),mOther=$tabLi.find("[rel='closeOther']"),mAll=$tabLi.find("[rel='closeAll']"),$tabLi=$this._getTabs();$tabLi.length<2&&(mCur.addClass("disabled"),mOther.addClass("disabled"),mAll.addClass("disabled")),0==$this._currentIndex||t.attr("tabid")==$this._op.mainTabId?(mCur.addClass("disabled"),t.attr("url")||mReload.addClass("disabled")):2==$tabLi.length&&mOther.addClass("disabled")}})},_getTabs:function(){return this._tabBox.find("> li")},_getPanels:function(){return this._panelBox.find("> div")},_getMoreLi:function(){return this._moreBox.find("> li")},_getTab:function(index){index=this._indexTabId(index);if(0<=index)return this._getTabs().eq(index)},getPanel:function(index){index=this._indexTabId(index);if(0<=index)return this._getPanels().eq(index)},_getTabsW:function(iStart,iEnd){return this._tabsW(this._getTabs().slice(iStart,iEnd))},_tabsW:function($tabs){var iW=0;return $tabs.each(function(){iW+=$(this).outerWidth(!0)}),iW},_indexTabId:function(tabid){if(!tabid)return-1;var iOpenIndex=-1;return this._getTabs().each(function(index){$(this).attr("tabid")==tabid&&(iOpenIndex=index)}),iOpenIndex},_getLeft:function(){return this._tabBox.position().left},_getScrollBarW:function(){return this.componentBox.width()-90},_visibleStart:function(){for(var iLeft=this._getLeft(),iW=0,$tabs=this._getTabs(),i=0;i<$tabs.length;i++){if(0<=iW+iLeft)return i;iW+=$tabs.eq(i).outerWidth(!0)}return 0},_visibleEnd:function(){for(var iLeft=this._getLeft(),iW=0,$tabs=this._getTabs(),i=0;i<$tabs.length;i++)if((iW+=$tabs.eq(i).outerWidth(!0))+iLeft>this._getScrollBarW())return i;return $tabs.length},_scrollPrev:function(){var iStart=this._visibleStart();iStart>=this.step?this._scrollTab(-this._getTabsW(0,iStart-this.step)):0<iStart&&this._scrollTab(-this._getTabsW(0,iStart-1))},_scrollNext:function(){var iEnd=this._visibleEnd();iEnd+this.step<=this._getTabs().length?this._scrollTab(-this._getTabsW(0,iEnd+this.step)+this._getScrollBarW()):iEnd<this._getTabs().length&&this._scrollTab(-this._getTabsW(0,iEnd+1)+this._getScrollBarW())},_scrollTab:function(iLeft,isNext){var $this=this;this._tabBox.animate({left:iLeft+"px"},200,function(){$this._ctrlScrollBut()})},_scrollCurrent:function(){var iW=this._tabsW(this._getTabs());iW<=this._getScrollBarW()?this._scrollTab(0):this._getLeft()<this._getScrollBarW()-iW?this._scrollTab(this._getScrollBarW()-iW):this._currentIndex<this._visibleStart()?this._scrollTab(-this._getTabsW(0,this._currentIndex)):this._currentIndex>=this._visibleEnd()&&this._scrollTab(this._getScrollBarW()-this._getTabs().eq(this._currentIndex).outerWidth(!0)-this._getTabsW(0,this._currentIndex))},_ctrlScrollBut:function(){var iW=this._tabsW(this._getTabs());this._getScrollBarW()>iW?(this._prevBut.hide(),this._nextBut.hide(),this._tabBox.parent().removeClass("tabsPageHeaderMargin")):(this._prevBut.show().removeClass("tabsLeftDisabled"),this._nextBut.show().removeClass("tabsRightDisabled"),this._tabBox.parent().addClass("tabsPageHeaderMargin"),0<=this._getLeft()?this._prevBut.addClass("tabsLeftDisabled"):this._getLeft()<=this._getScrollBarW()-iW&&this._nextBut.addClass("tabsRightDisabled"))},_switchTab:function(iTabIndex){var $tab=this._getTabs().removeClass("selected").eq(iTabIndex).addClass("selected");this._getPanels().hide().eq(iTabIndex).show(),this._getMoreLi().removeClass("selected").eq(iTabIndex).addClass("selected"),this._currentIndex=iTabIndex,this._scrollCurrent(),this._reload($tab)},_closeTab:function(index,openIndex){this._getTabs().eq(index).remove(),this._getPanels().eq(index).trigger(JUI.eventType.pageClear).remove(),this._getMoreLi().eq(index).remove(),this._currentIndex>=index&&this._currentIndex--,!openIndex||0<(openIndex=this._indexTabId(openIndex))&&(this._currentIndex=openIndex),this._init(),this._scrollCurrent(),this._reload(this._getTabs().eq(this._currentIndex))},closeTab:function(index){index=this._indexTabId(index);0<index&&this._closeTab(index)},closeCurrentTab:function(openTabid){0<this._currentIndex&&this._closeTab(this._currentIndex,openTabid)},closeAllTab:function(){this._getTabs().filter(":gt(0)").remove(),this._getPanels().filter(":gt(0)").trigger(JUI.eventType.pageClear).remove(),this._getMoreLi().filter(":gt(0)").remove(),this._currentIndex=0,this._init(),this._scrollCurrent()},_closeOtherTab:function(str$){0<(str$=str$||this._currentIndex)?(str$=":eq("+str$+")",this._getTabs().not(str$).filter(":gt(0)").remove(),this._getPanels().not(str$).filter(":gt(0)").trigger(JUI.eventType.pageClear).remove(),this._getMoreLi().not(str$).filter(":gt(0)").remove(),this._currentIndex=1,this._init(),this._scrollCurrent()):this.closeAllTab()},_loadUrlCallback:function($panel){$panel.find("[layoutH]").layoutH(),$panel.find(":button.close").click(function(){navTab.closeCurrentTab()})},_reload:function($tab,flag){flag=flag||$tab.data("reloadFlag");var $panel,$pagerForm,url=$tab.attr("url");flag&&url?($tab.data("reloadFlag",null),$panel=this.getPanel($tab.attr("tabid")),$tab.hasClass("external")||url.isExternalUrl()?navTab.openExternal(url,$panel):2==flag||0==($pagerForm=$(".pagerForm",$panel)).length?$panel.loadUrl(url,{},function(){navTab._loadUrlCallback($panel)}):$pagerForm.submit()):this.getCurrentPanel().trigger(JUI.eventType.resizeChart)},reloadFlag:function(tabid,value){var $tab=this._getTab(tabid);$tab&&(this._indexTabId(tabid)==this._currentIndex?this._reload($tab,!0):$tab.data("reloadFlag",value=value||1))},reload:function(url,$pagerForm){var op=$.extend({data:{},navTabId:"",callback:null},$pagerForm),$pagerForm=op.navTabId?this._getTab(op.navTabId):this._getTabs().eq(this._currentIndex),$panel=op.navTabId?this.getPanel(op.navTabId):this._getPanels().eq(this._currentIndex);$panel&&(url=url||$pagerForm.attr("url"))&&($pagerForm.hasClass("external")?navTab.openExternal(url,$panel):($.isEmptyObject(op.data)&&($pagerForm=$(".pagerForm",$panel),op.data=0<$pagerForm.length?$pagerForm.serializeArray():{}),$panel.ajaxUrl({type:"POST",url:url,data:op.data,callback:function(response){navTab._loadUrlCallback($panel),"function"==typeof op.callback&&op.callback(response)}})))},getCurrentPanel:function(){return this._getPanels().eq(this._currentIndex)},checkTimeout:function(){var json=JUI.jsonEval(this.getCurrentPanel().html());json&&json.statusCode==JUI.statusCode.timeout&&this.closeCurrentTab()},openExternal:function(url,$panel){var ih=navTab._panelBox.height();$panel.html(JUI.frag.externalFrag.replaceAll("{url}",url).replaceAll("{height}",ih+"px"))},openTab:function(tabid,url,$tabs){var $tab,$panel,op=$.extend({title:"New Tab",icon:"",data:{},fresh:!0,external:!1,focusNewWindow:!1},$tabs),$tabs=this._indexTabId(tabid);0<=$tabs&&!op.focusNewWindow?($tab=this._getTabs().eq($tabs),$panel=this._getPanels().eq($tabs),!op.fresh&&$tab.attr("url")==url||($tab.attr("url",url),op.external||url.isExternalUrl()?($tab.addClass("external"),navTab.openExternal(url,$panel)):($tab.removeClass("external"),$panel.ajaxUrl({type:"GET",url:url,data:op.data,callback:function(){navTab._loadUrlCallback($panel)}}))),this._currentIndex=$tabs):(op.focusNewWindow&&(tabid+=Math.round(1e7*Math.random())),this._getPanels().eq(this._currentIndex).after('<div class="page unitBox"></div>'),this._getTabs().eq(this._currentIndex).after($('<li><a href="javascript:;" class="close"><i class="icon-remove-sign"></i></a></li>').attr("tabid",tabid).prepend($('<a href="javascript:"></a>').attr("title",op.title).text(op.title).prepend(op.icon))),this._getMoreLi().eq(this._currentIndex).after($("<li></li>").append($('<a href="javascript:"></a>').attr("title",op.title).text(op.title).prepend(op.icon))),$tab=($tabs=this._getTabs()).eq(this._currentIndex+1),$panel=this._getPanels().eq(this._currentIndex+1),op.external||url.isExternalUrl()?($tab.addClass("external"),navTab.openExternal(url,$panel)):($tab.removeClass("external"),$panel.ajaxUrl({type:"GET",url:url,data:op.data,callback:function(){navTab._loadUrlCallback($panel)}})),$.History&&setTimeout(function(){$.History.addHistory($("#navMenu .selected a").attr("parentid")+"_"+tabid,function(i){i=i.substring(i.indexOf("_")+1),i=navTab._indexTabId(i);0<=i&&navTab._switchTab(i)},tabid)},10),this._currentIndex=this._currentIndex+1,this._contextmenu($tabs.eq(this._currentIndex))),this._init(),this._scrollCurrent(),this._getTabs().eq(this._currentIndex).attr("url",url)}};!function($){$.fn.extend({tabs:function(options){var op=$.extend({reverse:!1,eventType:"click",currentIndex:0,stTabHeader:"> .tabsHeader",stTab:">.tabsHeaderContent>ul",stTabPanel:"> .tabsContent",ajaxClass:"j-ajax",closeClass:"close",prevClass:"tabsLeft",nextClass:"tabsRight"},options);return this.each(function(){!function initTab(jT){var jSelector=jT.add($("> *",jT));var jTabHeader=$(op.stTabHeader,jSelector);var jTabs=$(op.stTab+" li",jTabHeader);var jGroups=$(op.stTabPanel+" > *",jSelector);jTabs.off().find("a").off();jTabHeader.find("."+op.prevClass).off();jTabHeader.find("."+op.nextClass).off();jTabs.each(function(iTabIndex){op.currentIndex==iTabIndex?$(this).addClass("selected"):$(this).removeClass("selected"),"hover"==op.eventType?$(this).on("mouseenter",function(event){switchTab(jT,iTabIndex)}):$(this).click(function(event){switchTab(jT,iTabIndex)}),$("a",this).each(function(){$(this).hasClass(op.ajaxClass)?$(this).click(function(event){var jGroup=jGroups.eq(iTabIndex);this.href&&!jGroup.attr("loaded")&&jGroup.loadUrl(this.href,{},function(){jGroup.find("[layoutH]").layoutH(),jGroup.attr("loaded",!0)}),event.preventDefault()}):$(this).hasClass(op.closeClass)&&$(this).click(function(event){return jTabs.eq(iTabIndex).remove(),jGroups.eq(iTabIndex).remove(),iTabIndex==op.currentIndex?op.currentIndex=iTabIndex+1<jTabs.length?iTabIndex:iTabIndex-1:iTabIndex<op.currentIndex&&(op.currentIndex=iTabIndex),initTab(jT),!1})})});switchTab(jT,op.currentIndex)}($(this))});function switchTab(jGroups,iTabIndex){var jGroup=jGroups.add($("> *",jGroups)),jTab=$(op.stTabHeader,jGroup),jTabs=$(op.stTab+" li",jTab),jGroups=$(op.stTabPanel+" > *",jGroup),jTab=jTabs.eq(iTabIndex),jGroup=jGroups.eq(iTabIndex);op.reverse&&jTab.hasClass("selected")?(jTabs.removeClass("selected"),jGroups.hide()):(op.currentIndex=iTabIndex,jTabs.removeClass("selected"),jTab.addClass("selected"),jGroups.hide().eq(op.currentIndex).show()),jGroup.attr("inited")||jGroup.attr("inited",1e3).find("input[type=text]").filter("[alt]").inputAlert()}}})}(jQuery),$.setRegional("alertMsg",{title:{error:"Error",info:"Information",warn:"Warning",correct:"Successful",confirm:"Confirmation"},butMsg:{ok:"OK",yes:"Yes",no:"No",cancel:"Cancel"}});var alertMsg={_boxId:"#alertMsgBox",_bgId:"#alertBackground",_closeTimer:null,_types:{error:"error",info:"info",warn:"warn",correct:"correct",confirm:"confirm"},_getTitle:function(key){return $.regional.alertMsg.title[key]},_keydownOk:function(event){if(event.keyCode==JUI.keyCode.ENTER||event.keyCode==JUI.keyCode.BACKSPACE)return event.data.target.trigger("click"),!1},_keydownEsc:function(event){event.keyCode==JUI.keyCode.ESC&&event.data.target.trigger("click")},_open:function(type,boxHtml,buttons){$(this._boxId).remove();var butsHtml="";if(buttons)for(var i=0;i<buttons.length;i++){var sRel=buttons[i].call?"callback":"";butsHtml+=JUI.frag.alertButFrag.replace("#butMsg#",buttons[i].name).replace("#callback#",sRel)}boxHtml=JUI.frag.alertBoxFrag.replace("#type#",type).replace("#title#",this._getTitle(type)).replace("#message#",boxHtml).replace("#butFragment#",butsHtml);$($.parseHTML(boxHtml,document,!0)).appendTo("body").css({top:-$(this._boxId).height()+"px"}).animate({top:"0px"},500),this._closeTimer&&(clearTimeout(this._closeTimer),this._closeTimer=null),this._types.info==type||this._types.correct==type?this._closeTimer=setTimeout(function(){alertMsg.close()},3500):$(this._bgId).show();for(var jButs=$(this._boxId).find("a.button"),jCallButs=jButs.filter("[rel=callback]"),jDoc=$(document),i=0;i<buttons.length;i++)buttons[i].call&&jCallButs.eq(i).click(buttons[i].call),buttons[i].keyCode==JUI.keyCode.ENTER&&jDoc.on("keydown",null,{target:jButs.eq(i)},this._keydownOk),buttons[i].keyCode==JUI.keyCode.ESC&&jDoc.on("keydown",null,{target:jButs.eq(i)},this._keydownEsc)},close:function(){$(document).off("keydown",null,this._keydownOk).off("keydown",null,this._keydownEsc),$(this._boxId).animate({top:-$(this._boxId).height()},100,function(){$(this).remove()}),$(this._bgId).hide(),this._callback&&(this._callback(),this._callback=null)},error:function(msg,options){this._alert(this._types.error,msg,options)},info:function(msg,options){this._alert(this._types.info,msg,options)},warn:function(msg,options){this._alert(this._types.warn,msg,options)},correct:function(msg,options){this._alert(this._types.correct,msg,options)},_alert:function(type,msg,options){var buttons={okName:$.regional.alertMsg.butMsg.ok,okCall:null};$.extend(buttons,options),options&&options.callback&&"function"==typeof options.callback&&(this._callback=options.callback);buttons=[{name:buttons.okName,call:buttons.okCall,keyCode:JUI.keyCode.ENTER}];this._open(type,msg,buttons)},confirm:function(msg,options){var buttons={okName:$.regional.alertMsg.butMsg.ok,okCall:null,cancelName:$.regional.alertMsg.butMsg.cancel,cancelCall:null};$.extend(buttons,options);buttons=[{name:buttons.okName,call:buttons.okCall,keyCode:JUI.keyCode.ENTER},{name:buttons.cancelName,call:buttons.cancelCall,keyCode:JUI.keyCode.ESC}];this._open(this._types.confirm,msg,buttons)}};function validateCallback(form,callback,confirmMsg){var $form=$(form);if($form.trigger(JUI.eventType.editorSync),!$form.valid())return!1;$("textarea.editor[escape=true],textarea.code[escape=true]",$form).each(function(){$(this).val(html2Escape($(this).val()))}),$("input[escape=true]",$form).each(function(){$(this).val()&&($(this).attr("escape",!1),$(this).attr("maxlength",128),$(this).val(sha512($(this).val())))});function _submitFn(){$.ajax({type:form.method||"POST",url:$form.attr("action"),data:$form.serializeArray(),dataType:"json",cache:!1,success:callback||JUI.ajaxDone,error:JUI.ajaxError})}return confirmMsg?alertMsg.confirm(confirmMsg,{okCall:_submitFn}):_submitFn(),!1}function iframeCallback(form,callback){var $form=$(form),$iframe=$("#callbackframe");if(!$form.valid())return!1;0==$iframe.length&&($iframe=$($.parseHTML("<iframe id='callbackframe' name='callbackframe' src='about:blank' style='display:none'></iframe>",document,!0)).appendTo("body")),form.ajax||$form.append('<input type="hidden" name="ajax" value="1" />'),form.target="callbackframe",_iframeResponse($iframe[0],callback||JUI.ajaxDone)}function _iframeResponse(iframe,callback){var $iframe=$(iframe),$document=$(document);$document.trigger("ajaxStart"),$iframe.on("load",null,null,function(event){if($iframe.off("load"),$document.trigger("ajaxStop"),"javascript:'%3Chtml%3E%3C/html%3E';"!=iframe.src&&"javascript:'<html></html>';"!=iframe.src){var response,doc=iframe.contentDocument||iframe.document;if(!(doc.readyState&&"complete"!=doc.readyState||doc.body&&"false"==doc.body.innerHTML)){if(doc.XMLDocument)response=doc.XMLDocument;else if(doc.body)try{response=$iframe.contents().find("body").text(),response=JSON.parse(response)}catch(e){response=doc.body.innerHTML}else response=doc;callback(response)}}})}function navTabAjaxDone(json){var $pagerForm;JUI.ajaxDone(json),json[JUI.keys.statusCode]==JUI.statusCode.ok&&(json.navTabId?"page"==json.rel?navTab.reloadFlag(json.navTabId,2):navTab.reloadFlag(json.navTabId):0!=($pagerForm=$(".pagerForm",navTab.getCurrentPanel())).length&&$pagerForm.submit(),"closeCurrent"==json.callbackType?setTimeout(function(){navTab.closeCurrentTab(json.navTabId)},100):"forward"==json.callbackType?json.navTabId?navTab.reload(json.forwardUrl,{navTabId:json.navTabId}):navTab.reload(json.forwardUrl):"forwardConfirm"==json.callbackType&&alertMsg.confirm(json.confirmMsg||JUI.msg("forwardConfirmMsg"),{okCall:function(){navTab.reload(json.forwardUrl)},cancelCall:function(){navTab.closeCurrentTab(json.navTabId)}}))}function dialogAjaxDone(json){var $pagerForm;JUI.ajaxDone(json),json[JUI.keys.statusCode]==JUI.statusCode.ok&&(json.navTabId?navTab.reload(json.forwardUrl,{navTabId:json.navTabId}):(navTab.getCurrentPanel(),0!=($pagerForm=$(".pagerForm",navTab.getCurrentPanel())).length&&$pagerForm.submit()),"closeCurrent"==json.callbackType&&$.pdialog.closeCurrent())}function navTabSearch($form,navTabId){$form=$($form);return navTab.reload($form.attr("action"),{data:$form.serializeArray(),navTabId:navTabId}),!1}function dialogSearch(form){var $form=$(form);return form[JUI.pageInfo.pageNum]&&(form[JUI.pageInfo.pageNum].value=1),$.pdialog.reload($form.attr("action"),{data:$form.serializeArray()}),!1}function divSearch(form,rel){var $box,$form=$(form);return form[JUI.pageInfo.pageNum]&&(form[JUI.pageInfo.pageNum].value=1),rel&&($box=$("#"+rel)).ajaxUrl({type:"POST",url:$form.attr("action"),data:$form.serializeArray(),callback:function(){$box.find("[layoutH]").layoutH()}}),!1}function _getPagerForm(form,args){form=$(".pagerForm",form).get(0);return form&&(args.pageNum&&(form[JUI.pageInfo.pageNum].value=args.pageNum),args.numPerPage&&(form[JUI.pageInfo.numPerPage].value=args.numPerPage),args.orderField&&(form[JUI.pageInfo.orderField].value=args.orderField),args.orderDirection&&form[JUI.pageInfo.orderDirection]&&(form[JUI.pageInfo.orderDirection].value=args.orderDirection)),form}function dwzPageBreak(params){var $box,form,op=$.extend({targetType:"navTab",rel:"",data:{pageNum:"",numPerPage:"",orderField:"",orderDirection:""},callback:null},params),params="dialog"==op.targetType?$.pdialog.getCurrent():navTab.getCurrentPanel();op.rel?(form=_getPagerForm($box=params.find("#"+op.rel),op.data))&&$box.ajaxUrl({type:"POST",url:$(form).attr("action"),data:$(form).serializeArray(),callback:function(){$box.find("[layoutH]").layoutH()}}):(form=_getPagerForm(params,op.data),params=$(form).serializeArray(),"dialog"==op.targetType?form&&$.pdialog.reload($(form).attr("action"),{data:params,callback:op.callback}):form&&navTab.reload($(form).attr("action"),{data:params,callback:op.callback}))}function navTabPageBreak(args,rel){dwzPageBreak({targetType:"navTab",rel:rel,data:args})}function dialogPageBreak(args,rel){dwzPageBreak({targetType:"dialog",rel:rel,data:args})}function ajaxTodo(url,callback){var $callback=callback||navTabAjaxDone;"function"!=typeof $callback&&($callback=eval("("+callback+")")),$.ajax({type:"POST",url:url,dataType:"json",cache:!1,success:$callback,error:JUI.ajaxError})}function uploadifyQueueComplete(queueData){var msg="The total number of files uploaded: "+queueData.uploadsSuccessful+"<br/>The total number of errors while uploading: "+queueData.uploadsErrored+"<br/>The total number of bytes uploaded: "+queueData.queueBytesUploaded+"<br/>The average speed of all uploaded files: "+queueData.averageSpeed;queueData.uploadsErrored?alertMsg.error(msg):alertMsg.correct(msg)}function uploadifySuccess(file,data,response){alert(data)}function uploadifyError(file,errorCode,errorMsg){alertMsg.error(errorCode+": "+errorMsg)}function uploadifyError(event,queueId,fileObj,errorObj){alert("event:"+event+"\nqueueId:"+queueId+"\nfileObj.name:"+fileObj.name+"\nerrorObj.type:"+errorObj.type+"\nerrorObj.info:"+errorObj.info)}!function($){$.pdialog={_op:{height:500,width:850,minH:40,minW:50,total:20,max:!1,mask:!1,resizable:!0,drawable:!0,maxable:!0,minable:!0,focusNewWindow:!1,fresh:!0},_current:null,_zIndex:42,getCurrent:function(){return this._current},reload:function(url,options){var jDContent,op=$.extend({data:{},dialogId:"",callback:null},options),dialog=op.dialogId&&$("body").data(op.dialogId)||this._current;dialog&&(jDContent=dialog.find(".dialogContent")).ajaxUrl({type:"POST",url:url,data:op.data,callback:function(response){jDContent.find("[layoutH]").layoutH(jDContent),$(":button.close",dialog).click(function(){return $.pdialog.close(dialog),!1}),"function"==typeof op.callback&&op.callback(response)}})},open:function(url,dlgid,title,options){var jDContent,op=$.extend({},$.pdialog._op,options),dialog=$("body").data(dlgid);dialog&&!op.focusNewWindow?(dialog.is(":hidden")&&dialog.show(),op.max&&($.pdialog.maxsize(dialog),dialog.jresize("destroy").dialogDrag("destroy")),!op.fresh&&url==dialog.data("url")||(dialog.data("url",url),dialog.find(".dialogHeader").find("h1").text(title),this.switchDialog(dialog),(jDContent=dialog.find(".dialogContent")).loadUrl(url,{},function(){jDContent.find("[layoutH]").layoutH(jDContent),$("button.close").click(function(){return $.pdialog.close(dialog),!1})}))):(op.focusNewWindow&&(dlgid+=Math.round(1e7*Math.random())),dialog=$($.parseHTML(JUI.frag.dialogFrag,document,!0)).appendTo($("body")),(dialog=$(dialog)).data("id",dlgid),dialog.data("url",url),options.close&&dialog.data("close",options.close),options.param&&dialog.data("param",options.param),dialog.find(".dialogHeader").find("h1").text(title),dialog.css("zIndex",$.pdialog._zIndex+=2),$.pdialog._init(dialog,options),dialog.click(function(){$.pdialog.switchDialog(dialog)}),op.resizable&&dialog.jresize(),op.drawable&&dialog.dialogDrag(),$("a.close",dialog).click(function(event){return $.pdialog.close(dialog),!1}),op.maxable?$("a.maximize",dialog).show().click(function(event){return $.pdialog.switchDialog(dialog),$.pdialog.maxsize(dialog),dialog.jresize("destroy").dialogDrag("destroy"),!1}):$("a.maximize",dialog).hide(),$("a.restore",dialog).click(function(event){return $.pdialog.restore(dialog),dialog.jresize().dialogDrag(),!1}),op.minable?$("a.minimize",dialog).show().click(function(event){return $.pdialog.minimize(dialog),!1}):$("a.minimize",dialog).hide(),$("div.dialogHeader a",dialog).mousedown(function(){return!1}),$("div.dialogHeader",dialog).dblclick(function(){($("a.restore",dialog).is(":hidden")?$("a.maximize",dialog):$("a.restore",dialog)).trigger("click")}),op.max&&($.pdialog.maxsize(dialog),dialog.jresize("destroy").dialogDrag("destroy")),$("body").data(dlgid,dialog),$.pdialog._current=dialog,(jDContent=$(".dialogContent",dialog)).loadUrl(url,{},function(){jDContent.find("[layoutH]").layoutH(jDContent),$("button.close").click(function(){return $.pdialog.close(dialog),!1})})),op.mask?(dialog.css("zIndex",1e3),$("a.minimize",dialog).hide(),dialog.data("mask",!0),$("#dialogBackground").show()):op.minable&&$.taskBar.addDialog(dlgid,title)},switchDialog:function(dialog){var cindex,index=dialog.css("zIndex");$.pdialog._current&&(cindex=$($.pdialog._current).css("zIndex"),$.pdialog._current.css("zIndex",index),dialog.css("zIndex",cindex),$.pdialog._current=dialog),$.taskBar.switchTask(dialog.data("id"))},_init:function(dialog,height){var iTop=$.extend({},this._op,height),height=iTop.height>iTop.minH?iTop.height<$(document).height()?iTop.height:$(document).height():iTop.minH,iTop=iTop.width>iTop.minW?iTop.width<$(document).width()?iTop.width:$(document).width():iTop.minW;(isNaN(dialog.height())||dialog.height()<height)&&(dialog.height(height),$(".dialogContent",dialog).height(height-$(".dialogHeader",dialog).outerHeight())),(isNaN(dialog.css("width"))||dialog.width()<iTop)&&dialog.width(iTop);iTop=($(window).height()-dialog.height())/2;dialog.css({left:($(window).width()-dialog.width())/2,top:0<iTop?iTop:0})},initResize:function(resizable,dialog,target){$("body").css("cursor",target+"-resize"),resizable.css({top:dialog.css("top"),left:dialog.css("left"),height:dialog.css("height"),width:dialog.css("width")}),resizable.show()},resizeDialog:function(width,dialog,content){var oleft=parseInt(width.style.left),otop=parseInt(width.style.top),height=parseInt(width.style.height),width=parseInt(width.style.width);tmove="n"==content||"nw"==content?parseInt(dialog.css("top"))-otop:height-parseInt(dialog.css("height")),dialog.css({left:oleft,width:width,top:otop,height:height}),$(".dialogContent",dialog).css("width",width-10+"px"),"w"!=content&&"e"!=content&&((content=$(".dialogContent",dialog)).css({height:height-$(".dialogHeader",dialog).outerHeight()}),content.find("[layoutH]").layoutH(content)),$(window).trigger(JUI.eventType.resizeGrid),$(window).trigger(JUI.eventType.resizeChart)},close:function(dialog){var close=(dialog="string"==typeof dialog?$("body").data(dialog):dialog).data("close");if(close&&"function"==typeof close){var param=dialog.data("param");if(!(param&&""!=param?close(param=JUI.jsonEval(param)):close()))return}dialog.hide(),dialog.data("mask")?$("#dialogBackground").hide():dialog.data("id")&&$.taskBar.closeDialog(dialog.data("id")),$("body").removeData(dialog.data("id")),dialog.trigger(JUI.eventType.pageClear).remove(),this._current=null},closeCurrent:function(){this.close($.pdialog._current)},checkTimeout:function(){var json=$(".dialogContent",$.pdialog._current),json=JUI.jsonEval(json.html());json&&json[JUI.keys.statusCode]==JUI.statusCode.timeout&&this.closeCurrent()},maxsize:function(dialog){dialog.data("original",{top:dialog.css("top"),left:dialog.css("left"),width:dialog.css("width"),height:dialog.css("height")}),$("a.maximize",dialog).hide(),$("a.restore",dialog).show();var iContentW=$(window).width(),iContentH=$(window).height()-$("footer").height();dialog.css({top:"0px",left:"0px",width:iContentW+"px",height:iContentH+"px"}),$.pdialog._resizeContent(dialog,iContentW,iContentH)},restore:function(dialog){var original=dialog.data("original"),dwidth=parseInt(original.width),dheight=parseInt(original.height);dialog.css({top:original.top,left:original.left,width:dwidth,height:dheight}),$.pdialog._resizeContent(dialog,dwidth,dheight),$("a.maximize",dialog).show(),$("a.restore",dialog).hide()},minimize:function(dialog){dialog.hide();var task=$.taskBar.getTask(dialog.data("id"));$(".resizable").css({top:dialog.css("top"),left:dialog.css("left"),height:dialog.css("height"),width:dialog.css("width")}).show().animate({top:$(window).height()-60,left:task.position().left,width:task.outerWidth(),height:task.outerHeight()},250,function(){$(this).hide(),$.taskBar.inactive(dialog.data("id"))})},_resizeContent:function(dialog,width,height){var content=$(".dialogContent",dialog);content.css({height:height-$(".dialogHeader",dialog).outerHeight()}),content.css("width",width-10+"px"),content.find("[layoutH]").layoutH(content),$(window).trigger(JUI.eventType.resizeGrid),$(window).trigger(JUI.eventType.resizeChart)}}}(jQuery),function($){$.fn.dialogDrag=function(options){return"string"==typeof options&&"destroy"==options?this.each(function(){$("div.dialogHeader",this).off("mousedown")}):this.each(function(){var dialog=$(this);$("div.dialogHeader",dialog).mousedown(function(e){return $.pdialog.switchDialog(dialog),dialog.data("task",!0),setTimeout(function(){dialog.data("task")&&$.dialogDrag.start(dialog,e)},100),!1}).mouseup(function(e){return dialog.data("task",!1),!1})})},$.dialogDrag={currId:null,_init:function(dialog){this.currId=(new Date).getTime();var shadow=$("#dialogProxy");shadow.length||(shadow=$(JUI.frag.dialogProxy),$("body").append(shadow)),$("h1",shadow).text($(".dialogHeader h1",dialog).text())},start:function(dialog,event){this._init(dialog);var sh=$("#dialogProxy");return sh.css({left:dialog.css("left"),top:dialog.css("top"),height:dialog.css("height"),width:dialog.css("width"),zIndex:parseInt(dialog.css("zIndex"))+1}).show(),$("div.dialogContent",sh).css("height",$("div.dialogContent",dialog).css("height")),sh.data("dialog",dialog),dialog.css({left:"-10000px",top:"-10000px"}),$(sh).jDrag({selector:".dialogHeader",stop:this.stop,event:event}),!1},stop:function(){var sh=$(arguments[0]);sh.data("dialog").css({left:$(sh).css("left"),top:$(sh).css("top")}),$(sh).hide()}}}(jQuery),function($){$.fn.extend({jresize:function(options){return"string"==typeof options&&"destroy"==options?this.each(function(){$("div[class^='resizable']",this).each(function(){$(this).hide()})}):this.each(function(){var dialog=$(this),resizable=$(".resizable");$("div[class^='resizable']",dialog).each(function(){var bar=this;$(bar).mousedown(function(event){return $.pdialog.switchDialog(dialog),$.resizeTool.start(resizable,dialog,event,$(bar).attr("tar")),!1}).show()})})}}),$.resizeTool={start:function(resizable,dialog,e,target){$.pdialog.initResize(resizable,dialog,target),$.data(resizable[0],"layer-drag",{options:$.extend($.pdialog._op,{target:target,dialog:dialog,stop:$.resizeTool.stop})}),$.layerdrag.start(resizable[0],e,$.pdialog._op)},stop:function(){var data=$.data(arguments[0],"layer-drag");$.pdialog.resizeDialog(arguments[0],data.options.dialog,data.options.target),$("body").css("cursor",""),$(arguments[0]).hide()}},$.layerdrag={start:function(obj,e,options){return $.layerdrag.current||($.layerdrag.current={el:obj,oleft:parseInt(obj.style.left)||0,owidth:parseInt(obj.style.width)||0,otop:parseInt(obj.style.top)||0,oheight:parseInt(obj.style.height)||0,ox:e.pageX||e.screenX,oy:e.pageY||e.clientY},$(document).on("mouseup",null,null,$.layerdrag.stop),$(document).on("mousemove",null,null,$.layerdrag.drag)),$.layerdrag.preventEvent(e)},drag:function(e){e=e||window.event;var current=$.layerdrag.current,height=$.data(current.el,"layer-drag"),lmove=(e.pageX||e.screenX)-current.ox,tmove=(e.pageY||e.clientY)-current.oy;if((e.pageY||e.clientY)<=0||(e.pageY||e.clientY)>=$(window).height()-$(".dialogHeader",$(height.options.dialog)).outerHeight())return!1;var target=height.options.target,width=current.owidth,height=current.oheight;return"n"!=target&&"s"!=target&&(width+=0<=target.indexOf("w")?-lmove:lmove),width>=$.pdialog._op.minW&&(0<=target.indexOf("w")&&(current.el.style.left=current.oleft+lmove+"px"),"n"!=target&&"s"!=target&&(current.el.style.width=width+"px")),"w"!=target&&"e"!=target&&(height+=0<=target.indexOf("n")?-tmove:tmove),height>=$.pdialog._op.minH&&(0<=target.indexOf("n")&&(current.el.style.top=current.otop+tmove+"px"),"w"!=target&&"e"!=target&&(current.el.style.height=height+"px")),$.layerdrag.preventEvent(e)},stop:function(e){var current=$.layerdrag.current,data=$.data(current.el,"layer-drag");return $(document).off("mousemove",null,$.layerdrag.drag),$(document).off("mouseup",null,$.layerdrag.stop),data.options.stop&&data.options.stop.apply(current.el,[current.el]),$.layerdrag.current=null,$.layerdrag.preventEvent(e)},preventEvent:function(e){return e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),!1}}}(jQuery),function($){$.fn.jTable=function(options){return this.each(function(){for(var $table=$(this),nowrapTD=$table.attr("nowrapTD"),tlength=$table.width(),aStyles=[],$tc=$table.parent().addClass("j-resizeGrid"),oldThs=$table.find("thead>tr:last-child").find("th"),i=0,l=oldThs.length;i<l;i++){var $th=$(oldThs[i]),style=[],width=$th.innerWidth()-100*$th.innerWidth()/tlength-2;style[0]=parseInt(width),style[1]=$th.attr("align"),aStyles[aStyles.length]=style}$(this).wrap("<div class='grid'></div>");var $grid=$table.parent().html($table.html()),thead=$grid.find("thead");thead.wrap("<div class='gridHeader'><div class='gridThead'><table style='width:"+(tlength-20)+"px;'></table></div></div>");var ths=$(">tr:last-child",thead),ths=$(">th",ths);$("th",thead).each(function(){var $th=$(this);$th.html("<div class='gridCol' title='"+$th.text()+"'>"+$th.html()+"</div>")}),ths.each(function(style){var $th=$(this),style=aStyles[style];$th.addClass(style[1]).removeAttr("align").removeAttr("width").width(style[0])}).filter("[orderField]").orderBy({targetType:$table.attr("targetType"),rel:$table.attr("rel"),asc:$table.attr("asc")||"asc",desc:$table.attr("desc")||"desc",orderField:$table.attr("orderField"),orderType:$table.attr("orderType")});var tbody=$grid.find(">tbody");tbody.wrap("<div class='gridScroller' layoutH style='width:"+$tc.width()+"px;'><div class='gridTbody'><table style='width:"+(tlength-20)+"px;'></table></div></div>");var ftr=$(">tr:first-child",tbody),$trs=tbody.find(">tr");$trs.each(function(){for(var $tr=$(this),$ftds=$(">td",this),i=0;i<$ftds.length;i++){var $ftd=$($ftds[i]);"false"!=nowrapTD&&$ftd.html("<div>"+$ftd.html()+"</div>"),i<aStyles.length&&$ftd.addClass(aStyles[i][1])}$tr.click(function(){$trs.filter(".selected").removeClass("selected"),$tr.addClass("selected");var sTarget=$tr.attr("target");sTarget&&(0==$("#"+sTarget,$grid).length&&$grid.prepend('<input id="'+sTarget+'" type="hidden" />'),$("#"+sTarget,$grid).val($tr.attr("rel")))}),$(".edit",$tr).length?$tr.dblclick(function(){$(".edit:eq(0)",$tr).click()}):$(".icon-edit",$.pdialog.getCurrent()?$.pdialog.getCurrent():navTab.getCurrentPanel()).length&&$tr.dblclick(function(){$(".icon-edit:eq(0)",$.pdialog.getCurrent()?$.pdialog.getCurrent():navTab.getCurrentPanel()).parent().click()})}),$(">td",ftr).each(function(i){i<aStyles.length&&$(this).width(aStyles[i][0])}),$grid.append("<div class='resizeMarker' style='height:300px; left:57px;display:none;'></div><div class='resizeProxy' style='height:300px; left:377px;display:none;'></div>");var scroller=$(".gridScroller",$grid);scroller.scroll(function(event){var scroll,header=$(".gridThead",$grid);return 0<scroller.scrollLeft()&&(header.css("position","relative"),scroll=scroller.scrollLeft(),header.css("left",scroller.cssv("left")-scroll)),0==scroller.scrollLeft()&&(header.css("position","relative"),header.css("left","0px")),!1}),$(">tr",thead).each(function(){$(">th",this).each(function(i){var th=this,$th=$(this);$th.mouseover(function(offset){offset=$.jTableTool.getOffset(th,offset).offsetX;return $th.outerWidth()-offset<5?$th.css("cursor","col-resize").mousedown(function(event){$(".resizeProxy",$grid).show().css({left:$.jTableTool.getRight(th)-$(".gridScroller",$grid).scrollLeft(),top:$.jTableTool.getTop(th),height:$.jTableTool.getHeight(th,$grid),cursor:"col-resize"}),$(".resizeMarker",$grid).show().css({left:$.jTableTool.getLeft(th)+1-$(".gridScroller",$grid).scrollLeft(),top:$.jTableTool.getTop(th),height:$.jTableTool.getHeight(th,$grid)}),$(".resizeProxy",$grid).jDrag($.extend(options,{scop:!0,cellMinW:20,relObj:$(".resizeMarker",$grid)[0],move:"horizontal",event:event,stop:function(){var newW=$(".resizeProxy",$grid).position().left-$(".resizeMarker",$grid).position().left-$th.outerWidth()-9,$table2=($.jTableTool.getColspan($th),$.jTableTool.getCellNum($th)),oldW=$th.width(),newW=$th.width()+newW,$table2=$(">td",ftr).eq($table2-1);$th.width(newW+"px"),$table2.width(newW+"px");$table2=$(thead).parent();$table2.width($table2.width()-oldW+newW+"px");$table2=$(tbody).parent();$table2.width($table2.width()-oldW+newW+"px"),$(".resizeMarker,.resizeProxy",$grid).hide()}}))}):($th.css("cursor",$th.attr("orderField")?"pointer":"default"),$th.off("mousedown")),!1})})}),$(window).off(JUI.eventType.resizeGrid).on("resizeGrid",null,null,function(){$("div.j-resizeGrid").each(function(){var width=$(this).innerWidth();width&&($("div.gridScroller",this).width(width+"px"),width-20>$("div.gridHeader>.gridThead>table",this).width()&&($("div.gridHeader>.gridThead>table",this).width(width-20+"px"),$("div.gridScroller>.gridTbody>table",this).width(width-20+"px")))})})})},$.jTableTool={getLeft:function(obj){var width=0;return $(obj).prevAll().each(function(){width+=$(this).outerWidth()}),width-1},getRight:function(obj){var width=0;return $(obj).prevAll().addBack().each(function(){width+=$(this).outerWidth()}),width-1},getTop:function(obj){var height=0;return $(obj).parent().prevAll().each(function(){height+=$(this).outerHeight()}),height},getHeight:function(obj,parent){var height=0;return $(obj).parent().nextAll().addBack().each(function(){height+=$(this).outerHeight()}),$(".gridTbody",parent).children().each(function(){height+=$(this).outerHeight()}),height},getCellNum:function(obj){return $(obj).prevAll().addBack().length},getColspan:function(obj){return $(obj).attr("colspan")||1},getStart:function(obj){var start=1;return $(obj).prevAll().each(function(){start+=parseInt($(this).attr("colspan")||1)}),start},getPageCoord:function(element){for(var coord={x:0,y:0};element;)coord.x+=element.offsetLeft,coord.y+=element.offsetTop,element=element.offsetParent;return coord},getOffset:function(evtset_offsetX,eventCoord_y){if(/msie/.test(navigator.userAgent.toLowerCase())){var pageCoord=$(evtset_offsetX).offset(),evtset_offsetX=eventCoord_y.pageX||eventCoord_y.screenX,eventCoord_x=eventCoord_y.pageY||eventCoord_y.screenY;return{offsetX:evtset_offsetX-pageCoord.left,offsetY:eventCoord_x-pageCoord.top}}eventCoord_x=eventCoord_y.target;null==eventCoord_x.offsetLeft&&(eventCoord_x=eventCoord_x.parentNode);pageCoord=$.jTableTool.getPageCoord(eventCoord_x),eventCoord_x=window.pageXOffset+eventCoord_y.clientX,eventCoord_y=window.pageYOffset+eventCoord_y.clientY;return{offsetX:eventCoord_x-pageCoord.x,offsetY:eventCoord_y-pageCoord.y}}}}(jQuery),function($){$.fn.extend({cssTable:function(options){return this.each(function(){var $this=$(this),$trs=$this.find("tbody>tr"),$grid=$this.parent();$trs.each(function(index){var $tr=$(this);$tr.click(function(){$trs.filter(".selected").removeClass("selected"),$tr.addClass("selected");var sTarget=$tr.attr("target");sTarget&&(0==$("#"+sTarget,$grid).length&&$grid.prepend('<input id="'+sTarget+'" type="hidden" />'),$("#"+sTarget,$grid).val($tr.attr("rel")))}),$(".edit",$tr).length?$tr.dblclick(function(){$(".edit:eq(0)",$tr).click()}):$(".panelBar .icon-edit",$.pdialog.getCurrent()?$.pdialog.getCurrent():navTab.getCurrentPanel()).length&&$tr.dblclick(function(){$(".panelBar .icon-edit:eq(0)",$.pdialog.getCurrent()?$.pdialog.getCurrent():navTab.getCurrentPanel()).parent().click()})}),$this.find("thead [orderField]").orderBy({targetType:$this.attr("targetType"),rel:$this.attr("rel"),asc:$this.attr("asc")||"asc",desc:$this.attr("desc")||"desc",orderField:$this.attr("orderField"),orderType:$this.attr("orderType")})})}})}(jQuery),function($){$.fn.extend({orderBy:function(options){var op=$.extend({targetType:"navTab",rel:"",asc:"asc",desc:"desc",orderType:"",orderField:""},options);return this.each(function(){var $this=$(this).click(function(){var orderField=$this.attr("orderField"),orderDirection=$this.hasClass(op.asc)?op.desc:op.asc;dwzPageBreak({targetType:op.targetType,rel:op.rel,data:{orderField:orderField,orderDirection:orderDirection}})});op.orderField==$this.attr("orderField")?op.asc==op.orderType?$this.addClass(op.asc):op.desc==op.orderType?$this.addClass(op.desc):$this.addClass("order"):$this.addClass("order")})}})}(jQuery),function($){$.fn.extend({jTask:function(options){return this.each(function(){var $task=$(this),id=$task.attr("id");$task.click(function(e){var dialog=$("body").data(id);return $task.hasClass("selected")?$("a.minimize",dialog).trigger("click"):$(dialog).is(":hidden")?$.taskBar.restoreDialog(dialog):$(dialog).trigger("click"),$.taskBar.scrollCurrent($(this)),!1}),$("div.close",$task).click(function(e){return $.pdialog.close(id),!1})})}}),$.taskBar={_taskBar:null,_taskBox:null,_prevBut:null,_nextBut:null,_op:{id:"taskbar",taskBox:"div.taskbarContent",prevBut:".taskbarLeft",prevDis:"taskbarLeftDisabled",nextBut:".taskbarRight",nextDis:"taskbarRightDisabled",selected:"selected",boxMargin:"taskbarMargin"},init:function(options){var $this=this;$.extend(this._op,options),this._taskBar=$("#"+this._op.id),0==this._taskBar.length&&(this._taskBar=$($.parseHTML(JUI.frag.taskbar,document,!0)).appendTo($("body")),this._taskBar.find(".taskbarLeft"),this._taskBar.find(".taskbarRight")),this._taskBox=this._taskBar.find(this._op.taskBox),this._taskList=this._taskBox.find(">ul"),this._prevBut=this._taskBar.find(this._op.prevBut),this._nextBut=this._taskBar.find(this._op.nextBut),this._prevBut.click(function(e){$this.scrollLeft()}),this._nextBut.click(function(e){$this.scrollRight()}),this._contextmenu(this._taskBox)},_contextmenu:function(obj){$(obj).contextMenu("dialogCM",{bindings:{closeCurrent:function(obj,m){obj=obj.isTag("li")?obj:$.taskBar._getCurrent();$("div.close",obj).trigger("click")},closeOther:function(selector,m){var selector=selector.isTag("li")?"#"+selector.attr("id"):".selected",tasks=$.taskBar._taskList.find(">li:not(:"+selector+")");tasks.each(function(i){$("div.close",tasks[i]).trigger("click")})},closeAll:function(t,m){var tasks=$.taskBar._getTasks();tasks.each(function(i){$("div.close",tasks[i]).trigger("click")})}},ctrSub:function(t,mOther){var mCur=mOther.find("[rel='closeCurrent']"),mOther=mOther.find("[rel='closeOther']");$.taskBar._getCurrent()[0]?1==$.taskBar._getTasks().length&&mOther.addClass("disabled"):(mCur.addClass("disabled"),mOther.addClass("disabled"))}})},_scrollCurrent:function(){var $this,left;this._tasksW(this._getTasks())>this._getTaskBarW()?(left=$(">li:last-child",($this=this)._taskList),left=this._getTaskBarW()-left.position().left-left.outerWidth(!0),this._taskList.animate({left:left+"px"},200,function(){$this._ctrlScrollBut()})):this._ctrlScrollBut()},_getTaskBarW:function(){return this._taskBox.width()-(this._prevBut.is(":hidden")?this._prevBut.width()+2:0)-(this._nextBut.is(":hidden")?this._nextBut.width()+2:0)},_scrollTask:function(task){var left,$this=this;task.position().left+this._getLeft()+task.outerWidth()>this._getBarWidth()?(left=this._getTaskBarW()-task.position().left-task.outerWidth(!0)-2,this._taskList.animate({left:left+"px"},200,function(){$this._ctrlScrollBut()})):task.position().left+this._getLeft()<0&&(left=this._getLeft()-(task.position().left+this._getLeft()),this._taskList.animate({left:left+"px"},200,function(){$this._ctrlScrollBut()}))},_ctrlScrollBut:function(){var iW=this._tasksW(this._getTasks());this._getTaskBarW()>iW?(this._taskBox.removeClass(this._op.boxMargin),this._nextBut.hide(),this._prevBut.hide(),this._getTasks().eq(0)[0]&&this._scrollTask(this._getTasks().eq(0))):(this._taskBox.addClass(this._op.boxMargin),this._nextBut.show().removeClass(this._op.nextDis),this._prevBut.show().removeClass(this._op.prevDis),0<=this._getLeft()&&this._prevBut.addClass(this._op.prevDis),this._getLeft()<=this._getTaskBarW()-iW&&this._nextBut.addClass(this._op.nextDis))},_getLeft:function(){return this._taskList.position().left},_visibleStart:function(){for(var iLeft=this._getLeft(),jTasks=this._getTasks(),i=0;i<jTasks.length;i++)if(0<=jTasks.eq(i).position().left+jTasks.eq(i).outerWidth(!0)+iLeft)return jTasks.eq(i);return jTasks.eq(0)},_visibleEnd:function(){for(var iLeft=this._getLeft(),jTasks=this._getTasks(),i=0;i<jTasks.length;i++)if(jTasks.eq(i).position().left+jTasks.eq(i).outerWidth(!0)+iLeft>this._getBarWidth())return jTasks.eq(i);return jTasks.eq(jTasks.length-1)},_getTasks:function(){return this._taskList.find(">li")},_tasksW:function(jTasks){var iW=0;return jTasks.each(function(){iW+=$(this).outerWidth(!0)}),iW},_getBarWidth:function(){return this._taskBar.innerWidth()},addDialog:function(id,title){this.show();var task=$("#"+id,this._taskList);task[0]?$(">div.taskbutton",task).text(title):(this._taskList.append('<li id="#taskid#"><div class="taskbutton">#title#</div><div class="close"><i class="icon-remove"></i></div></li>'.replace("#taskid#",id).replace("#title#",title)),(task=$("#"+id,this._taskList)).jTask()),this._contextmenu(task),this.switchTask(id),this._scrollTask(task)},closeDialog:function(obj){("string"==typeof obj?$("#"+obj,this._taskList):obj).remove(),0==this._getTasks().length&&this.hide(),this._scrollCurrent()},restoreDialog:function(task){var dialog="string"==typeof task?$("body").data(task):task,id="string"==typeof task?task:dialog.data("id"),task=$.taskBar.getTask(id);$(".resizable").css({top:$(window).height()-60,left:$(task).position().left,height:$(task).outerHeight(),width:$(task).outerWidth()}).show().animate({top:$(dialog).css("top"),left:$(dialog).css("left"),width:$(dialog).css("width"),height:$(dialog).css("height")},250,function(){$(this).hide(),$(dialog).show(),$.pdialog._current=dialog}),$.taskBar.switchTask(id)},inactive:function(id){$("#"+id,this._taskList).removeClass("selected")},scrollLeft:function(){var task=this._visibleStart();this._scrollTask(task)},scrollRight:function(){var task=this._visibleEnd();this._scrollTask(task)},scrollCurrent:function(task){this._scrollTask(task)},switchTask:function(id){this._getCurrent().removeClass("selected"),this.getTask(id).addClass("selected")},_getCurrent:function(){return this._taskList.find(">.selected")},getTask:function(id){return $("#"+id,this._taskList)},show:function(){this._taskBar.is(":hidden")&&(this._taskBar.css("top",$(window).height()-34+this._taskBar.outerHeight()).show(),this._taskBar.animate({top:$(window).height()-this._taskBar.outerHeight()},500))},hide:function(){this._taskBar.animate({top:$(window).height()-29+this._taskBar.outerHeight(!0)},500,function(){$.taskBar._taskBar.hide()})}}}(jQuery),function($){$.extend({History:{_hash:new Array,_currentHash:"",_callback:void 0,init:function(iframe){$.History._callback=iframe;var current_hash=location.hash.replace(/\?.*$/,"");$.History._currentHash=current_hash,$.support.leadingWhitespace||(""==$.History._currentHash&&($.History._currentHash="#"),$("body").append('<iframe id="jQuery_history" style="display: none;" src="about:blank"></iframe>'),(iframe=(iframe=$("#jQuery_history")[0]).contentDocument||iframe.contentWindow.document).open(),iframe.close(),iframe.location.hash=current_hash),"function"==typeof this._callback&&$.History._callback(current_hash.skipChar("#")),setInterval($.History._historyCheck,100)},_historyCheck:function(){var current_hash="";(current_hash=($.support.leadingWhitespace?location:$("#jQuery_history")[0].contentWindow.location).hash.skipChar("#").replace(/\?.*$/,""))!=$.History._currentHash&&($.History._currentHash=current_hash,$.History.loadHistory(current_hash))},addHistory:function(hash,fun,iframe){$.History._currentHash=hash,$.History._hash.push([hash,fun,iframe]),$.support.leadingWhitespace||((iframe=(iframe=$("#jQuery_history")[0]).contentDocument||iframe.contentWindow.document).open(),iframe.close(),iframe.location.hash=hash.replace(/\?.*$/,"")),location.hash=hash.replace(/\?.*$/,"")},loadHistory:function(hash){$.support.leadingWhitespace||(location.hash=hash);for(var i=0;i<$.History._hash.length;i+=1)if($.History._hash[i][0]==hash)return void $.History._hash[i][1]($.History._hash[i][2])}}})}(jQuery),$.fn.extend({ajaxTodo:function(){return this.each(function(){var $this=$(this);$this.click(function(event){var url=$this.attr("href").replaceTmById($(event.target).parents(".unitBox:first"));if(JUI.debug(url),!url.isFinishedTm())return alertMsg.error($this.attr("warn")||JUI.msg("alertSelectMsg")),!1;var title=$this.attr("title");title?alertMsg.confirm(title,{okCall:function(){ajaxTodo(url,$this.attr("callback"))}}):ajaxTodo(url,$this.attr("callback")),event.preventDefault()})})},dwzExport:function(){function _doExport(url){var $form="dialog"==url.attr("targetType")?$.pdialog.getCurrent():navTab.getCurrentPanel(),$form=$(".pagerForm",$form),url=url.attr("href");window.location=url+(-1==url.indexOf("?")?"?":"&")+$form.serialize()}return this.each(function(){var $this=$(this);$this.click(function(event){var title=$this.attr("title");title?alertMsg.confirm(title,{okCall:function(){_doExport($this)}}):_doExport($this),event.preventDefault()})})}}),function($){var _lookup={currentGroup:"",suffix:"",$target:null,pk:"id",nextButton:null},_util={_lookupPrefix:function(key){var strDot=_lookup.currentGroup?".":"";return _lookup.currentGroup+strDot+key+_lookup.suffix},lookupPk:function(key){return this._lookupPrefix(key)},lookupField:function(key){return this.lookupPk(key)}};$.extend({bringBackSuggest:function(args){_lookup.$target.parents(".unitBox:first").find(":input").each(function(){var key,$input=$(this),inputName=$input.attr("name");for(key in args){var name=_lookup.pk==key?_util.lookupPk(key):_util.lookupField(key);if(name==inputName&&""!=name){$input.hasClass("editor")?"ckeditor"==$input.attr("editorType")?CKEDITOR.instances[$input.data("id")].setData(args[key]):"tinymce"==$input.attr("editorType")?tinymce.get($input.data("id")).setContent(args[key]):"kindeditor"==$input.attr("editorType")?KindEditor.html("#"+$input.data("id"),args[key]):UE.instants[$input.data("id")].setContent(args[key]):$input.hasClass("code")?JUI.instances[$(this).data("id")].setValue(args[key]):$input.val(args[key]).trigger("change");break}}})},bringBack:function(json){json[JUI.keys.statusCode]==JUI.statusCode.error?json[JUI.keys.message]&&alertMsg.error(json[JUI.keys.message]):json[JUI.keys.statusCode]==JUI.statusCode.timeout?alertMsg.error(json[JUI.keys.message]||JUI.msg("sessionTimout"),{okCall:function(){JUI.loadLogin()}}):($.bringBackSuggest(json),$.pdialog.closeCurrent())},batchBringBack:function(args){if(_lookup.nextButton)for(var row in args){if(_lookup.nextButton.click(),args[row][JUI.keys.statusCode]==JUI.statusCode.error){args[row][JUI.keys.message]&&alertMsg.error(args[row][JUI.keys.message]);break}if(args[row][JUI.keys.statusCode]==JUI.statusCode.timeout){alertMsg.error(args[row][JUI.keys.message]||JUI.msg("sessionTimout"),{okCall:function(){JUI.loadLogin()}});break}$.bringBackSuggest(args[row])}$.pdialog.closeCurrent()}}),$.fn.extend({lookup:function(){return this.each(function(){var $this=$(this),options={mask:!0,width:$this.attr("width")||820,height:$this.attr("height")||500,maxable:eval($this.attr("maxable")||"true"),resizable:eval($this.attr("resizable")||"true")};$this.click(function(url){_lookup=$.extend(_lookup,{currentGroup:$this.attr("lookupGroup")||"",suffix:$this.attr("suffix")||"",$target:$this,pk:$this.attr("lookupPk")||""});url=$this.attr("href").replaceTmById($(url.target).parents(".unitBox:first"));return url.isFinishedTm()?$.pdialog.open(url,"_blank",$this.attr("title")||$this.text(),options):alertMsg.error($this.attr("warn")||JUI.msg("alertSelectMsg")),!1})})},multLookup:function(){return this.each(function(){var $this=$(this),args={};$this.click(function(event){return $this.parents(".unitBox:first").find("[name='"+$this.attr("multLookup")+"']").filter(":checked").each(function(){var key,_args=JUI.jsonEval($(this).val());for(key in _args){var value=args[key]?args[key]+",":"";args[key]=value+_args[key]}}),$.isEmptyObject(args)?alertMsg.error($this.attr("warn")||JUI.msg("alertSelectMsg")):$.bringBack(args),!1})})},suggest:function(){var op_suggest$="#suggest",selectedIndex=-1;return this.each(function(){var $input=$(this).attr("autocomplete","off").keydown(function(event){if(event.keyCode==JUI.keyCode.ENTER&&$(op_suggest$).is(":visible"))return!1}),suggestFields=$input.attr("suggestFields").split(",");function _show(event){var url=$input.offset(),postData=url.top+this.offsetHeight,$suggest=$(op_suggest$);($suggest=0==$suggest.length?$('<div id="suggest"></div>').appendTo($("body")):$suggest).css({left:url.left+"px",top:postData+"px"}).show(),_lookup=$.extend(_lookup,{currentGroup:$input.attr("lookupGroup")||"",suffix:$input.attr("suffix")||"",$target:$input,pk:$input.attr("lookupPk")||""});url=$input.attr("suggestUrl").replaceTmById($(event.target).parents(".unitBox:first"));if(!url.isFinishedTm())return alertMsg.error($input.attr("warn")||JUI.msg("alertSelectMsg")),!1;postData={};return postData[$input.attr("postField")||"inputValue"]=$input.val(),$.ajax({global:!1,type:"POST",dataType:"json",url:url,cache:!1,data:postData,success:function($lis){if($lis){var html="";$.each($lis,function(i){for(var key,liAttr="",liLabel="",i=0;i<suggestFields.length;i++){var str=this[suggestFields[i]];str&&(liLabel&&(liLabel+="-"),liLabel+=str)}for(key in this)liAttr&&(liAttr+=","),liAttr+=key+":'"+this[key]+"'";html+='<li lookupAttrs="'+liAttr+'">'+liLabel+"</li>"});$lis=$suggest.html("<ul>"+html+"</ul>").find("li");if($lis.click(function(){_select($(this)),$input.next().hasClass("suggestButton")&&$input.next().click()}),0==$lis.length){$suggest.hide();for(var jsonStr="",i=0;i<suggestFields.length&&_util.lookupField(suggestFields[i])!=event.target.name;i++)jsonStr&&(jsonStr+=","),jsonStr+=suggestFields[i]+":''";jsonStr="{"+_lookup.pk+":'',"+jsonStr+"}",$.bringBackSuggest(JUI.jsonEval(jsonStr))}}},error:function(){$suggest.html("")}}),$(document).on("click",null,null,_close),!1}function _select(jsonStr){jsonStr="{"+jsonStr.attr("lookupAttrs")+"}";$.bringBackSuggest(JUI.jsonEval(jsonStr))}function _close(){$(op_suggest$).html("").hide(),selectedIndex=-1,$(document).off("click",null,_close)}$input.focus(_show).click(!1).keyup(function(event){var $items=$(op_suggest$).find("li");switch(event.keyCode){case JUI.keyCode.ESC:case JUI.keyCode.TAB:case JUI.keyCode.SHIFT:case JUI.keyCode.HOME:case JUI.keyCode.END:case JUI.keyCode.LEFT:case JUI.keyCode.RIGHT:break;case JUI.keyCode.ENTER:_close();break;case JUI.keyCode.DOWN:selectedIndex>=$items.length-1?selectedIndex=-1:selectedIndex++;break;case JUI.keyCode.UP:selectedIndex<0?selectedIndex=$items.length-1:selectedIndex--;break;default:_show(event)}$items.removeClass("selected"),0<=selectedIndex&&_select($items.eq(selectedIndex).addClass("selected"))})})},itemDetail:function(){return this.each(function(){var $table=$(this).css("clear","both"),$tbody=$table.find("tbody"),fields=[];$table.find("tr:first th[type]").each(function(i){var field=$(this),field={type:field.attr("type")||"text",patternDate:field.attr("dateFmt")||"yyyy-MM-dd",name:field.attr("name")||"",defaultVal:escapeHtml(field.attr("defaultVal")||""),size:field.attr("size")||"12",enumUrl:field.attr("enumUrl")||"",lookupGroup:field.attr("lookupGroup")||"",lookupUrl:field.attr("lookupUrl")||"",lookupPk:field.attr("lookupPk")||"id",suggestUrl:field.attr("suggestUrl"),suggestFields:field.attr("suggestFields"),postField:field.attr("postField")||"",fieldClass:field.attr("fieldClass")||"",fieldAttrs:field.attr("fieldAttrs")||"",title:field.text(),pkValue:field.attr("pkValue")};fields.push(field)}),$tbody.find("a.btnDel").click(function(){var $btnDel=$(this);return $btnDel.is("[href^=javascript]")?($btnDel.parents("tr:first").remove(),initSuffix($tbody)):$btnDel.attr("title")?alertMsg.confirm($btnDel.attr("title"),{okCall:delDbData}):delDbData(),!1;function delDbData(){$.ajax({type:"POST",dataType:"json",url:$btnDel.attr("href"),cache:!1,success:function(){$btnDel.parents("tr:first").remove(),initSuffix($tbody)},error:JUI.ajaxError})}});var $addBut,batchUploadUrl,$rowNum,trTm,batchButtonTxt=$table.attr("addButton")||"Add New";batchButtonTxt&&($addBut=$('<label style="width:auto;"><button type="button" class="button">'+batchButtonTxt+"</button></label>").insertBefore($table).find("button"),batchButtonTxt=$table.attr("batchButton")||"Batch upload",(batchUploadUrl=$table.attr("batchUploadUrl"))?$('<label><a class="button" lookupGroup="" href="'+batchUploadUrl+'" width="1000" height="600" >'+batchButtonTxt+"</a></label>").initUI().insertBefore($table).find("a").click(function(){_lookup=$.extend(_lookup,{nextButton:$addBut})}):$rowNum=$('<label><input type="text" name="dwz_rowNum" class="textInput" value="1" size="2"/></label>').insertBefore($table).find("input"),trTm="",$addBut.click(function(){trTm=trTm||function(fields){var html="";return $(fields).each(function(){html+=function(field){var hiddenHtml="",html="",suffix="";field.name.endsWith("[#index#]")?suffix="[#index#]":field.name.endsWith("[]")&&(suffix="[]");var suffixFrag=suffix?' suffix="'+suffix+'" ':"",attrFrag="";if(field.fieldAttrs){var key,attrs=JUI.jsonEval(field.fieldAttrs);for(key in attrs)attrFrag+=key+'="'+attrs[key]+'"'}{var value;field.lookupPk&&(value="",field.pkValue&&(value=field.pkValue),hiddenHtml='<input type="hidden" name="'+field.lookupGroup+"."+field.lookupPk+suffix+'" value="'+value+'"/>')}switch(field.type){case"del":html='<a href="javascript:void(0)" class="btnDel '+field.fieldClass+'"></a>';break;case"lookup":var suggestFrag="";field.suggestFields&&(suggestFrag='autocomplete="off" lookupGroup="'+field.lookupGroup+'"'+suffixFrag+' suggestUrl="'+field.suggestUrl+'" suggestFields="'+field.suggestFields+'" postField="'+field.postField+'"'),html='<input type="text" name="'+field.name+'"'+suggestFrag+' lookupPk="'+field.lookupPk+'" size="'+field.size+'" class="'+field.fieldClass+'" '+attrFrag+'/><a class="btnLook" href="'+field.lookupUrl+'" lookupGroup="'+field.lookupGroup+'" '+suggestFrag+' lookupPk="'+field.lookupPk+'" '+attrFrag+">"+field.title+"</a>";break;case"attach":html='<input type="text" name="'+field.name+'" size="'+field.size+'" class="'+field.fieldClass+'" '+attrFrag+'/><a class="btnAttach" href="'+field.lookupUrl+'" lookupGroup="'+field.lookupGroup+'" '+suffixFrag+' lookupPk="'+field.lookupPk+'" width="1000" height="600" '+attrFrag+">"+field.title+"</a>";break;case"enum":$.ajax({type:"POST",dataType:"html",async:!1,url:field.enumUrl,data:{inputName:field.name},success:function(response){html=response}});break;case"date":html='<input type="text" name="'+field.name+'" value="'+field.defaultVal+'" class="date '+field.fieldClass+'" dateFmt="'+field.patternDate+'" size="'+field.size+'" '+attrFrag+"/>";break;case"checkbox":html='<input type="checkbox" name="'+field.name+'" class="'+field.fieldClass+'" '+attrFrag+"/>";break;case"textarea":html='<textarea name="'+field.name+'" class="'+field.fieldClass+'" '+attrFrag+">"+field.defaultVal+"</textarea>";break;case"number":html='<input type="number" name="'+field.name+'" value="'+field.defaultVal+'" size="'+field.size+'" class="'+field.fieldClass+'" '+attrFrag+"/>";break;default:html='<input type="text" name="'+field.name+'" value="'+field.defaultVal+'" size="'+field.size+'" class="'+field.fieldClass+'" '+attrFrag+"/>"}return"<td>"+hiddenHtml+html+"</td>"}(this)}),'<tr class="unitBox">'+html+"</tr>"}(fields);var rowNum=1;if(!batchUploadUrl)try{rowNum=parseInt($rowNum.val())}catch(e){}for(var i=0;i<rowNum;i++){var $tr=$($.parseHTML(trTm,document,!0));$tr.appendTo($tbody).initUI().find("a.btnDel").click(function(){return $(this).parents("tr:first").remove(),initSuffix($tbody),!1})}initSuffix($tbody);var $attach=$tr.find(".btnAttach");batchUploadUrl&&$attach&&(_lookup=$.extend(_lookup,{currentGroup:$attach.attr("lookupGroup")||"",suffix:$attach.attr("suffix")||"",$target:$attach,pk:$attach.attr("lookupPk")||""}))}))});function initSuffix($tbody){$tbody.find(">tr").each(function(i){$(":input, a.btnLook, a.btnAttach",this).each(function(){var $this=$(this),suffix=$this.attr("name"),val=$this.val();suffix&&$this.attr("name",suffix.replaceSuffix(i));suffix=$this.attr("lookupGroup");suffix&&$this.attr("lookupGroup",suffix.replaceSuffix(i));suffix=$this.attr("suffix");suffix&&$this.attr("suffix",suffix.replaceSuffix(i)),val&&0<=val.indexOf("#index#")&&$this.val(val.replace("#index#",i+1))})})}},selectedTodo:function(){function _getIds(selectedIds,targetType){var ids="";return("dialog"==targetType?$.pdialog.getCurrent():navTab.getCurrentPanel()).find("input:checked").filter("[name='"+selectedIds+"']").each(function(i){var val=$(this).val();ids+=0==i?val:","+val}),ids}return this.each(function(){var $this=$(this),selectedIds=$this.attr("rel")||"ids",postType=$this.attr("postType")||"map";$this.click(function(){var targetType=$this.attr("targetType"),ids=_getIds(selectedIds,targetType);if(!ids)return alertMsg.error($this.attr("warn")||JUI.msg("alertSelectMsg")),!1;var _callback=$this.attr("callback")||("dialog"==targetType?dialogAjaxDone:navTabAjaxDone);function _doPost(){$.ajax({type:"POST",url:$this.attr("href"),dataType:"json",cache:!1,data:function(){if("map"==postType)return $.map(ids.split(","),function(val,i){return{name:selectedIds,value:val}});var _data={};return _data[selectedIds]=ids,_data}(),success:_callback,error:JUI.ajaxError})}"function"!=typeof _callback&&(_callback=eval("("+_callback+")"));var title=$this.attr("title");return title?alertMsg.confirm(title,{okCall:_doPost}):_doPost(),!1})})}})}(jQuery),function($){function _onchange(event){var $ref=$("select[name="+escapeJquery(event.data.$this.attr("ref"))+"]");if(0==$ref.length)return!1;event.data.$this.attr("index")&&($ref=$ref.eq(event.data.$this.attr("index"))),$.ajax({type:"POST",dataType:"json",url:event.data.$this.attr("refUrl").replace("{value}",encodeURIComponent(event.data.$this.val())),cache:!1,data:{},success:function(json){var $refCombox;json&&($ref.empty(),$.each(json,function(i){json[i]&&1<json[i].length&&$("<option></option>").attr("value",json[i][0]).text(json[i][1]).appendTo($ref)}),$refCombox=$ref.parents("div.combox:first"),$ref.insertAfter($refCombox),$refCombox.remove(),$ref.trigger("change").combox())},error:JUI.ajaxError})}var allSelectBox=[],killAllBox=function(bid){$.each(allSelectBox,function(i){allSelectBox[i]!=bid&&($("#"+allSelectBox[i])[0]?$("#op_"+allSelectBox[i]).css({height:"",width:""}).hide():$("#op_"+allSelectBox[i]).remove(),$("#"+allSelectBox[i]).children("a").removeClass("expand"),$(document).off("click",null,killAllBox))})};$.extend($.fn,{comboxSelect:function(options){var op=$.extend({selector:">a"},options);return this.each(function(){var box=$(this),selector=$(op.selector,box);allSelectBox.push(box.attr("id")),$(op.selector,box).click(function(){var top,left,options=$("#op_"+box.attr("id")),optionlist=$("ul",options);return options.is(":hidden")?(box.children("a").addClass("expand"),600<options.height()&&options.addClass("lot"),300<options.height()&&optionlist.css({height:"300px"}),(top=box.offset().top+box[0].offsetHeight+1)+options.outerHeight(!0)>$(window).height()-20&&(top=top-box.outerHeight(!0)-options.outerHeight(!0)-1),(left=box.offset().left)+options.outerWidth(!0)>$(window).width()&&(left=$(window).width()-options.outerWidth(!0)-1),options.css({top:top,left:left}).show(),$("a.selected",options).length&&0==optionlist.scrollTop()&&optionlist.stop().animate({scrollTop:$("a.selected",optionlist).offset().top+60-options.height()-optionlist.offset().top},500),$(".search input",options).focus().keyup(function(){var val=$(this).val();val?($("li",optionlist).hide(),$("li a:contains("+escapeJquery(val)+")",optionlist).parent().show(),$("li a",optionlist).each(function(){-1<$(this).attr("value").indexOf(val)&&$(this).parent().show()})):$("li",optionlist).show(),$("li.disabled",optionlist).hide()}).click(function(){return!1}).val(""),$("li",optionlist).show(),$("li.disabled",optionlist).hide(),killAllBox(box.attr("id")),$(document).click(killAllBox)):($(document).off("click",null,killAllBox),killAllBox()),!1}),$("#op_"+box.attr("id")).find(" li").comboxOption(selector,box)})},comboxOption:function(selector,box){return this.each(function(){$(">a",this).click(function(){var $this=$(this);$this.parent().parent().find(".selected").removeClass("selected"),$this.addClass("selected"),selector.text($this.text()),$("select",box).val()!=$this.attr("value")&&$("select",box).val($this.attr("value")).trigger("change")})})},combox:function(){var _selectBox=[];return $.each(allSelectBox,function(i){$("#"+allSelectBox[i])[0]?_selectBox.push(allSelectBox[i]):$("#op_"+allSelectBox[i]).remove()}),allSelectBox=_selectBox,this.each(function(i){var $this=$(this).removeClass("combox"),select=$this.parents("div.combox:first");select.length&&($this.insertAfter(select),select.remove()),$this.hasClass("requiredIfNotEmpty")&&(0==$("option",$this).length||1==$("option",$this).length&&!$("option",$this).val()?$this.removeClass("required"):$this.addClass("required"));var name=$this.attr("name"),value=$this.val(),label="";void 0!==value&&value?label=$("option[value="+escapeJquery(value)+"]",$this).text():""==value&&(label=$("option[value='']",$this).text());var ref=$this.attr("ref"),refUrl=$this.attr("refUrl")||"",cid=$this.attr("id")||Math.round(1e7*Math.random()),select='<div class="combox"><div id="combox_'+cid+'" class="select"'+(ref?' ref="'+escapeHtml(ref)+'"':"")+">";select+='<a href="javascript:" class="'+$this.attr("class")+'" name="'+name+'" value="'+escapeHtml(value)+'">'+label+"</a></div></div>";var options='<div class="comboxop" id="op_combox_'+cid+'"><div class="search"><input type="text" class="textInput"/></div><ul>';$("option",$this).each(function(){var option=$(this);options+='<li><a class="'+(value==option[0].value?"selected":"")+'" href="#" title="'+escapeHtml(option[0].text)+'" value="'+escapeHtml(option[0].value)+'">'+escapeHtml(option[0].text)+"</a></li>"}),options+="</ul></div>",$("body").append(options),$this.after(select),$("div.select",$this.next()).comboxSelect().append($this),ref&&refUrl&&$this.off("change",null,_onchange).on("change",null,{$this:$this},_onchange)})},comboxDisable:function(){return this.each(function(){$(this).parents(".combox .select:first").addClass("disabled")})},comboxEnable:function(){return this.each(function(){$(this).parents(".combox .select:first").removeClass("disabled")})},comboxVal:function(val){return this.each(function(){var $box=$(this).parents(".combox .select:first");$("#op_"+$box.attr("id")).find('>li a[value="'+escapeJquery(val)+'"]').trigger("click")})}})}(jQuery),function($){$.fn.extend({checkboxCtrl:function(parent){return this.each(function(){var $trigger=$(this);$trigger.click(function(){var type,group=$trigger.attr("group");$trigger.is(":checkbox")?(type=$trigger.is(":checked")?"all":"none",group&&$.checkbox.select(group,type,parent)):group&&$.checkbox.select(group,$trigger.attr("selectType")||"all",parent)})})}}),$.checkbox={selectAll:function(_name,_parent){this.select(_name,"all",_parent)},unSelectAll:function(_name,_parent){this.select(_name,"none",_parent)},selectInvert:function(_name,_parent){this.select(_name,"invert",_parent)},select:function(_name,_type,_parent){switch($parent=$(_parent||document),$checkboxLi=$parent.find(":checkbox[name='"+_name+"']"),_type){case"invert":$checkboxLi.each(function(){$checkbox=$(this),$checkbox.prop("checked",!$checkbox.is(":checked"))});break;case"none":$checkboxLi.prop("checked",!1);break;default:$checkboxLi.prop("checked",!0)}}}}(jQuery),function($){$.validator&&($.validator.addMethod("alphanumeric",function(value,element){return this.optional(element)||/^\w+$/i.test(value)},"Letters, numbers or underscores only please"),$.validator.addMethod("lettersonly",function(value,element){return this.optional(element)||/^[a-z]+$/i.test(value)},"Letters only please"),$.validator.addMethod("letterstart",function(value,element){return this.optional(element)||/^[a-z]+\w+$/i.test(value)},"Letters, numbers or underscores only  please,The first character must be letter"),$.validator.addMethod("phone",function(value,element){return this.optional(element)||/^[0-9 \(\)]{7,30}$/.test(value)},"Please specify a valid phone number"),$.validator.addMethod("postcode",function(value,element){return this.optional(element)||/^[0-9 A-Za-z]{5,20}$/.test(value)},"Please specify a valid postcode"),$.validator.addMethod("domain",function(value,element){return this.optional(element)||/^((((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|(\[?((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\]?)|(localhost)|(loopback)|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)*)?$/i.test(value)},"Please specify a valid domain"),$.validator.addMethod("date",function(value,element){if(value=value.replace(/\s+/g,""),String.prototype.parseDate){var $input=$(element),pattern=$input.attr("dateFmt")||"yyyy-MM-dd";return!$input.val()||$input.val().parseDate(pattern)}return this.optional(element)||value.match(/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/)},"Please enter a valid date."),$.validator.addMethod("customvalid",function(value,element,params){try{return eval("("+params+")")}catch(e){return!1}},"Please fix this field."),$.validator.addClassRules({date:{date:!0},alphanumeric:{alphanumeric:!0},lettersonly:{lettersonly:!0},phone:{phone:!0},postcode:{postcode:!0}}),$.validator.setDefaults({errorElement:"span"}),$.validator.autoCreateRanges=!0)}(jQuery),function($){function readAsDataURL(img,file,maxW,maxH){var aImg,reader=new FileReader;reader.onload=(aImg=img,function(height){aImg.src=height.target.result;var width=aImg.naturalWidth,height=aImg.naturalHeight;aImg.setAttribute("data-width",width),aImg.setAttribute("data-height",height),maxW&&maxH&&(maxW<width&&aImg.setAttribute("width",maxW),maxH<height&&aImg.setAttribute("height",maxH))}),reader.readAsDataURL(file)}function editImg($uploadWrap,img,filenames,callback){0==$uploadWrap.parent().find(".image-editor").length&&$uploadWrap.after('<div class="image-editor"><div class="unit"><p class="nowrap"><a href="javascript:;" class="button"><i class="icon-ok"></i></a></p><p class="image-box"></p></div></div>');var $this=$uploadWrap.parent().find(".image-editor");$this.attr("data-id")&&JUI.instances[$this.attr("data-id")].destroy();var dataId="photoclip_"+window.photoclip.index++,widthInput=$uploadWrap.find("input[name=width]"),heightInput=$uploadWrap.find("input[name=height]");widthInput.change(function(){JUI.instances[$uploadWrap.parent().find(".image-editor").data("id")]&&JUI.instances[$uploadWrap.parent().find(".image-editor").data("id")].size(parseInt(widthInput.val()),parseInt(heightInput.val()))}),heightInput.change(function(){JUI.instances[$uploadWrap.parent().find(".image-editor").data("id")]&&JUI.instances[$uploadWrap.parent().find(".image-editor").data("id")].size(parseInt(widthInput.val()),parseInt(heightInput.val()))});var options={size:[parseInt(widthInput.val()),parseInt(heightInput.val())],ok:$this.find(".button"),done:function(dataURL){$.isFunction(callback)&&callback(dataURL),JUI.instances[dataId].destroy(),delete JUI.instances[dataId],$this.remove()},fail:function(msg){alertMsg.error(msg)}},filenames=filenames.split(".");function init(dataId,img){var photoClip=new PhotoClip($this.find(".image-box")[0],options);photoClip.load(img),JUI.instances[dataId]=photoClip}"png"==filenames[filenames.length-1]&&(options.outputType="png"),window.photoclip.initd?init(dataId,img):loadScripts(window.photoclip.resources,function(){window.photoclip.initd=!0,init(dataId,img)}),$this.attr("data-id",dataId)}$.fn.extend({editImg:function(options){$uploadWrap=$(this);var $previewElem=$uploadWrap.find(".thumbnail");0==$previewElem.length&&($previewElem=$('<div class="thumbnail"></div>').appendTo($uploadWrap));var img=document.createElement("img");img.src=options.imgUrl,$previewElem.empty().append(img),editImg($(this),options.imgUrl,options.imgName,function(dataURL){dataURL&&(img.src=dataURL,$uploadWrap.find("input[name=base64File]").val(dataURL.substring(dataURL.indexOf("base64,")+7)),$uploadWrap.find("input[name=originalFilename]").val(options.imgName),$uploadWrap.find("input[type=file]").val(""),0==$previewElem.find(".del-icon").length&&$('<a class="del-icon"></a>').appendTo($previewElem).click(function(event){$previewElem.remove(),$uploadWrap.find("input[name=base64File]").val(""),$uploadWrap.find("input[name=originalFilename]").val("")}))})}}),$.fn.extend({previewUploadImg:function(options){var op=$.extend({maxW:80,maxH:80},options);return this.each(function(){var $uploadWrap=$(this);$uploadWrap.find("input[type=file]").each(function(index){$(this).css({left:op.maxW*index+"px"}).on("change",function(){var files=this.files;(this.multiple?function(rel,files,maxW,maxH){var rel=rel.attr("rel"),$previewElem=$(rel);$previewElem.empty();for(var index=0;index<files.length;index++){var file=files[index],$thumb=$('<li class="thumbnail"></li>'),img=document.createElement("img");img.file=file,$thumb.append(img),$previewElem.append($thumb),readAsDataURL(img,file,maxW,maxH)}}:function($uploadWrap,files,maxW,maxH){var $previewElem=$('<div class="thumbnail"></div>').appendTo($uploadWrap),file=files[0];if(file){if(!file.type.match(/image.*/))throw"File Type must be an image";var img=document.createElement("img");img.file=file,$previewElem.empty().append(img),0==$previewElem.find(".del-icon").length&&$('<a class="del-icon"></a>').appendTo($previewElem).click(function(event){$previewElem.remove(),$uploadWrap.find("input[type=file]").val("")}),0==$previewElem.find(".edit-icon").length&&$('<a class="edit-icon"></a>').appendTo($previewElem).click(function(event){editImg($uploadWrap,file,file.name,function(dataURL){dataURL&&(img.src=dataURL,$uploadWrap.find("input[name=base64File]").val(dataURL.substring(dataURL.indexOf("base64,")+7)),$uploadWrap.find("input[name=originalFilename]").val(file.name),$uploadWrap.find("input[type=file]").val(""))})}),readAsDataURL(img,file,maxW,maxH)}})($uploadWrap,files,op.maxW,op.maxH)})});var $delIcon=$uploadWrap.find(".del-icon");$delIcon&&$delIcon.click(function(event){return $.ajax({type:"GET",url:$delIcon.attr("href"),dataType:"json",cache:!1,success:function(json){JUI.ajaxDone(json),json[JUI.keys.statusCode]==JUI.statusCode.ok&&($uploadWrap.find("div.thumbnail").remove(),$uploadWrap.find("input[type=file]").val(""))},error:JUI.ajaxError}),!1})})}}),JUI.regPlugins.push(function($p){$("div.upload-wrap",$p).previewUploadImg({maxW:300,maxH:200})})}(jQuery);